非侵入式家電負載解析技術精進與商業
應用模式研究
完成報告





台灣電力股份有限公司
中華民國111年9月











  



非侵入式家電負載解析技術精進與商業
應用模式研究
完成報告


受委託單位：財團法人工業技術研究院
研究主持人：蔡宗成
協同主持人：蔡宗霖
研究人員：林政廷、章學賢、陳束弘、許湘伶

台電執行計畫單位：綜合研究所
研究主持人：楊新全
研究人員：黃秉偉、張宇琦


研究期程：中華民國110年6月8日至111年6月7日
研究經費：新臺幣846萬元

台灣電力股份有限公司  委託研究
中華民國111年9月

摘要
透過智慧電表之大數據分析以開創各種商業加值服務，為電業自由化後，全球電業公司目前正積極發展之業務方向。非侵入式家電負載解析(Non Intrusive Appliance Load Monitoring, NIALM)技術為智慧電表大數據分析之重要關鍵技術，利用智慧電表所提供之每分鐘或每15分鐘之電力參數，透過人工智慧(Artificial Intelligence, AI)機器學習(Machine Learning)演算法，解析出主要家電之用電負載，以提供節電、負載移轉等需求面管理(Demand Side Management, DSM)，以及老人居家活動偵測照護等加值應用服務。本計畫首先收集國際電業有關NIALM之成功商業應用案例，並了解其細部技術需求及商業運作模式，然後參考其作法，開發高頻暫態電力特徵之NIALM技術，以提升用電解析性能並可適用於多種類家電之解析以符合居家活動偵測之照護應用所需；另外基於已建構好NIALM模型樣本家庭戶之基礎上，發展低頻穩態特徵之NIALM遷移學習技術，利用非電力資訊之相似性比對，以樣本家庭戶之低頻電力特徵NIALM模型，來解析非模型訓練智慧電表用戶之細部用電，以利擴大相關應用之商業推廣。此外本計畫更進一步研究NIALM與使用者行為(Instrumental Activities of Daily Living)之關聯。完成上述技術開發後，亦將導入實場域進行技術及商業模式驗證，並進而規劃出後續異業結盟之商業合作模式。
中文關鍵詞：非侵入式家電負載解析、智慧電表、遷移式學習

 
Abstract
Analysis of big data analysis collected from smart electric meters has been used to explore various commercial value-added services. It is a business direction that global electricity companies have been proactively developing after energy liberalization. Nonintrusive appliance load monitoring (NIALM) is a key knowledge in big data analysis for smart electric meters. It tracks data of electricity parameters provided by smart electric meters every 1 or 15 min and employs artificial intelligence and machine learning to analyze the load of major household appliances. The analysis results may be used for demand side management, such as power conservation and load shift, as well as for value-added services such as activity detection and care for older adults at home. This study first collected cases of successful NIALM applications in the electricity industry worldwide and examined their technology demand and business operation models in detail. On the basis of their methods, we developed an NIALM technology with high-frequency transient electricity features to increase the performance of electricity use analysis. This technology is applicable to the analysis of various types of household appliances and meets the care application requirements for home activity detection. Using the NIALM model based on the data of a sample household, we developed NIALM transfer learning technology with low-frequency steady state features. The similarities of non-electricity data were compared, and the low-frequency electricity feature NIALM model of the sample household was used to analyze details in the electricity use of smart electric meter user without model training. This in turn facilitates the application scope of the developed technology in relevant commercial uses. This study further investigated the relationship between NIALM and users’ instrumental activities of daily living. After the completion of the aforementioned technologies, we will implement them in practical settings to verify the relevant technology and business models, thereby planning subsequent business models for collaboration across different industries.
Key Words: Smart Meter, Non-Intrusive Appliance Load Monitoring, Transfer Learning.
目錄
摘要	I
Abstract	II
目錄	IV
圖目錄	VII
表目錄	XVI
第一章、緒論	19
1.1、計畫背景	19
1.2、計畫目標與架構	22
1.3、計畫成效	24
1.4、國內外有關本計畫研究情形	24
第二章、國際最新NIALM商業應用技術發展調研	26
2.1、美國Whole-House Energy Monitoring Systems-“sense”	27
2.2、美國-Grid4C智慧電網分析服務公司	32
2.3、美國Bidgely Inc.的B2B2C商業發展應用	35
2.4、歐洲利用智慧能源數據進行遠端居家照護之研究	39
2.5、日本關西電力公司生活方式節奏通知服務	44
2.6、日本東京電力公司遠處亦安心(遠くても安心)遠端觀護服務	48
2.7、美、歐、日之NIALM商業應用案例分析歸納	64
第三章、高頻電力特徵NIALM技術開發	71
3.1、高頻電力特徵NIALM系統架構	73
3.2、小波轉換	79
3.3、Parseval理論	82
3.4、支持向量機	84
3.5、鳳山實驗屋27個設備啟動電流波形	86
3.6、鳳山實驗屋13個設備關閉電流波形	99
3.7、實作量測負載辨識率	105
3.8、高頻暫態特徵實驗結論	125
第四章、低頻電力特徵之NIALM遷移學習技術開發	132
4.1、遷移學習技術之定義及分類	132
4.2、遷移學習技術執行方法	141
4.3、遷移學習之模型讀取(Load Model)	151
4.4、CTL Load Disaggregation負載用電解析	156
4.5、準確度評估指標	162
4.6、CTL遷移式學習精進	166
4.7、HEMS計畫之智慧電表Route B資料整合	174
4.8、示範住戶實場技術驗證	178
第五章、高頻穩態NIALM應用之技術精進	182
5.1、NIALM高頻穩態前期計畫與後期計畫作法分析	182
5.2、國內NIALM示範場域性能驗證	187
5.3、國內NIALM示範場域性能分析	193
第六章、高頻穩態NIALM之示範住戶實場應用	195
6.1、高頻穩態示範住戶招募程序	195
6.2、高頻穩態用電資料收集系統與展示架構	205
6.3、外部資料傳遞至台電綜研所內網之運作流程	210
6.4、高頻穩態NIALM應用之異業結盟商業模式	212
6.5、「用電作息異常通知」照護情境模擬試驗	216
第七章、NIALM與使用者行為關聯研究	227
7.1、以人為中心之非監督式學習分解方法研析	227
7.2、鳳山實驗屋家電設備與環境說明	231
7.3、鳳山實驗屋實作IADL分析人事時地物	237
7.4、用電與行為模式關聯分析研究應用於真實示範住戶	244
第八章、結論與建議	254
8.1 結論	254
8.2 建議	258
參考資料	260

圖目錄
圖1-1、非侵入式設備負載監視(NIALM)方法架構	21
圖1-2、計畫工作項目分年列表圖	22
圖1-3、非侵入式家電負載解析技術精進與商業應用模式研究架構	23
圖2-1、美國Sense Labs公司的非入侵式負載監控產品	27
圖2-2、美國Sense Labs產品安裝於住宅配電箱內	28
圖2-3、美國Sense Labs分析烤麵包機負載電流曲線	29
圖2-4、美國Sense Labs分析照明設備負載(白熾燈泡)負載電流曲線	30
圖2-5、美國Grid4C公司網路服務平台示意	32
圖2-6、澳洲聯合能源公司行為需量反應解決方案	38
圖2-7、歐洲20/20health期刊發表智慧電表數據於健康和護理支持	39
圖2-8、關西電力(はぴe まもるくん方案)推測電力使用”生活節奏”	45
圖2-9、日本關西電力公司的生活方式節奏通知服務之分析架構	47
圖2-10、東電與Informetis合資成立Energy Gateway	49
圖2-11、日本東電遠處亦安心遠端觀護服務-8種家電使用狀況通知	50
圖2-12、遠處亦安心遠端觀護服務-入戶安裝流程	50
圖2-13、遠處亦安心遠端觀護服務- App畫面	52
圖2-14、遠處亦安心遠端觀護服務-4項情境服務	53
圖2-15、日本東電NIALM傳感器外觀與公開規格	54
圖2-16、日本東電NIALM傳感器硬體規格	55
圖2-17、Energy Gateway家用蓄電池AI優化控制系統	56
圖2-18、Informetis -電力數據和機器學習使用單個傳感器	57
圖2-19、Informetis -家電分離技術研究和發展的方法	58
圖2-20、Informetis公司NIALM發展定位	59
圖2-21、ヤブシタエネシス株式會社提供新商業服務「AI見守」	60
圖2-22、ヤブシタエネシス株式會社之「AI見守」服務內容	61
圖2-23、醫學研究家電的使用時間分析長者認知障礙	63
圖3-1、不平衡單相三線式220V/110V配電網路	73
圖3-2、非侵入式高頻暫態監測系統電力特徵萃取流程圖	75
圖3-3、非侵入式高頻暫態啟動及關閉LabView監測系統圖(a)啟動(b)關閉	78
圖3-4、離散小波轉換示意圖	81
圖3-5、客廳吹風機啟動電流波形圖	86
圖3-6、主臥空氣清淨機啟動電流波形圖	86
圖3-7、主臥除溼機2啟動電流波形圖	87
圖3-8、客廳智慧電視啟動電流波形圖	87
圖3-9、客廳電風扇2啟動電流波形圖	88
圖3-10、主臥電風扇3啟動電流波形圖	88
圖3-11、客廳55吋液晶顯示器與視訊盒啟動電流波形圖	89
圖3-12、廚房冰箱啟動電流波形圖	89
圖3-13、客廳空調1啟動電流波形圖	90
圖3-14、主臥空調2啟動電流波形圖	90
圖3-15、次臥空調3啟動電流波形圖	91
圖3-16、後陽台洗衣機啟動電流波形圖	91
圖3-17、客廳乾衣機啟動電流波形圖	92
圖3-18、客廳智慧照明1啟動電流波形圖	92
圖3-19、餐廳智慧照明2啟動電流波形圖	93
圖3-20、主臥智慧照明3啟動電流波形圖	93
圖3-21、主臥智慧照明4啟動電流波形圖	94
圖3-22、次臥智慧照明5啟動電流波形圖	94
圖3-23、前陽台照明1啟動電流波形圖	95
圖3-24、廚房照明2啟動電流波形圖	95
圖3-25、後陽台照明3啟動電流波形圖	96
圖3-26、走道照明4啟動電流波形圖	96
圖3-27、廁所照明5啟動電流波形圖	97
圖3-28、浴室照明6啟動電流波形圖	97
圖3-29、廚房電飯鍋啟動電流波形圖	97
圖3-30、廚房電磁爐啟動電流波形圖	98
圖3-31、後陽台電熱水器啟動電流波形圖	98
圖3-32、客廳吹風機關閉電流波形圖	99
圖3-33、主臥空氣清淨機關閉電流波形圖	99
圖3-34、主臥除溼機2關閉電流波形圖	100
圖3-35、客廳智慧電視關閉電流波形圖	100
圖3-36、客廳電風扇2關閉電流波形圖	101
圖3-37、客廳55吋液晶顯示器與視訊盒關閉電流波形圖	101
圖3-38、廚房冰箱關閉電流波形圖	102
圖3-39、客廳空調1關閉電流波形圖	102
圖3-40、後陽台洗衣機關閉電流波形圖	102
圖3-41、客廳乾衣機關閉電流波形圖	103
圖3-42、廚房電飯鍋關閉電流波形圖	103
圖3-43、廚房電磁爐關閉電流波形圖	103
圖3-44、後陽台電熱水器關閉電流波形圖	104
圖4-1、遷移學習的學習過程	132
圖4-2、基於實例的深度遷移學習	134
圖4-3、顯示基於實例的深度遷移學習的示意圖	136
圖4-4、基於網路之深度遷移學習	137
圖4-5、基於對抗的深度遷移學習	139
圖4-6、遷移式學習之預測架構	141
圖4-7、UK-DALE以及REFIT跨源域遷移式學習評估結果	142
圖4-8、REDD以及REFIT跨源域遷移式學習評估結果	143
圖4-9、問卷調查電視使用時間分布	145
圖4-10、問卷調查電鍋使用時間分布	145
圖4-11、問卷調查洗衣機使用時間分布	146
圖4-12、問卷調查電腦使用時間分布	146
圖4-13、問卷調查吹風機使用時間分布	147
圖4-14、某示範住戶電鍋指紋模型示意	149
圖4-15、某示範住戶洗衣機指紋模型示意	149
圖4-16、某示範住戶電視指紋模型示意	149
圖4-17、某示範住戶冷氣指紋模型示意	150
圖4-18、某示範住戶電風扇指紋模型示意	150
圖4-19、某示範住戶照明指紋模型示意	150
圖4-20、遷移學習的Load Model架構	151
圖4-21、某示範住戶的Load Model架構	152
圖4-22、總用電與空調實際用電之負載曲線	153
圖4-23、總用電與空調用電解析預測之負載曲線	153
圖4-24、利用空調模型A遷移學習解析該示範住戶空調用電	154
圖4-25、利用空調模型B遷移學習解析該示範住戶空調用電	154
圖4-26、利用空調模型C遷移學習解析該示範住戶空調用電	154
圖4-27、利用空調模型D遷移學習解析該示範住戶空調用電	155
圖4-28、將一日24時切割成4個時間區間示意	156
圖4-29、判斷該量值之空調狀態是否為開啟狀態示意	157
圖4-30、切割一segment作遷移學習，尋找最適當模型架構示意	158
圖4-31、計算區域segment之不同模型r值	159
圖4-32、示範住戶A問卷調查分析家內電器設備的使用時間	165
圖4-33、與HEMS計畫協作之資料整合架構	174
圖4-34、雲端FTP的Route B原始資料	175
圖4-35、線性插補方法示意圖	177
圖4-36、經過遷移式學習演算法執行並輸出結果	177
圖4-37、示範住戶A藉由插座電表量測設備電力資料	179
圖4-38、示範住戶A透過遷移式學習演算法解析出設備電力資料	179
圖5-1、NIALM性能驗證流程說明	186
圖6-1、本期示範住戶招募管道及時程與入戶安裝流程	196
圖6-2、示範住戶入戶安裝高頻穩態電表系統裝置圖	197
圖6-3、高頻穩態NIALM資料透過MQTT資料流	205
圖6-4、InfluxDB支援時序資料儲存與多語言程式開發	207
圖6-5、使用Grafana儀表板顯示用電資訊	209
圖6-6、外部資料傳遞至台電綜研所內網之運作流程	210
圖6-7、用戶服務大數據平台的資料輸入格式範例	211
圖6-8、日本東京電力與關西電力公司之B2C商業模式整理	213
圖6-9、本計畫高頻穩態NIALM應用之商業模式	214
圖6-10、住宅總用電收集7天建立用電行為觀察	217
圖6-11、包絡線(Envelope)原理	217
圖6-12、應用包絡線(Envelope)原理形成觀察範圍	218
圖6-13、不同示範住戶的用電行為包絡線	218
圖6-14、由用電行為包絡線產生家居照護五線譜	219
圖6-15、觀察住戶用電行為是否與前7天包絡線有差異狀況	220
圖6-16、不同觀察窗口之家居照護五線譜與九宮格應用情境	220
圖6-17、用戶用電量之間的巨大差異的觀護儀表板	223
圖6-18、用電量突升示意圖	225
圖7-1、公開資料集提供之家庭結構資訊	228
圖7-2、公開資料集提供之家電使用行為資訊	229
圖7-3、公開資料集提供之各家庭擁有電器數量統計	230
圖7-4、以家庭結構及家電使用行為資訊做NIALM解析之概念圖	231
圖7-5、前期計畫之鳳山實驗屋開關箱與室內設備佈置圖	232
圖7-6、本期計畫之鳳山實驗屋室內配線重整圖	234
圖7-7、本期計畫之鳳山實驗屋開關箱更新	235
圖7-8、本期計畫之鳳山實驗屋室內等軸測投影圖	236
圖7-9、高頻暫態實驗的目標家電位置與室內迴路關係位置圖	236
圖7-10、鳳山實驗屋實作IADL分析人事時地物	238
圖7-11、人員在實驗屋模擬獨居長者在家生活第一天	239
圖7-12、人員在實驗屋模擬獨居長者在家生活第二天	239
圖7-13、人員在實驗屋模擬獨居長者在家生活第三天	240
圖7-14、人員在實驗屋模擬獨居長者在家生活第四天	240
圖7-15、人員在實驗屋模擬獨居長者在家生活第五天	241
圖7-16、人員在實驗屋模擬獨居長者在家生活第六天	241
圖7-17、人員在實驗屋模擬獨居長者在家生活第七天	242
圖7-18、年長者A獨自在家各設備使用情況(1/12~1/14)	244
圖7-19、年長者A獨自在家各設備使用情況(1/15~1/17)	245
圖7-20、年長者A獨自在家各設備使用情況(1/18~1/19)	245
圖7-21、年長者A+B在家各設備使用情況(1/8~1/9)	246
圖7-22、年長者A+B在家各設備使用情況(1/10~1/11)	246
圖7-23、年長者A在家低耗電設備使用情況(1/12~1/13)	247
圖7-24、年長者A在家低耗電設備使用情況(1/14~1/15)	247
圖7-25、年長者A在家低耗電設備使用情況(1/16~1/17)	248
圖7-26、年長者A在家低耗電設備使用情況(1/18~1/19)	248
圖7-27、年長者A+B在家低耗電設備使用情況(1/8~1/9)	249
圖7-28、年長者A+B在家低耗電設備使用情況(1/10~1/11)	249
圖7-29、C0群的群中心總用電負載曲線	251
圖7-30、C1群的群中心總用電負載曲線	251
圖7-31、家電擺放之空間位置資訊以及住宅平面圖	252
圖7-32、照順序編號1~9表示各時間點在家中行為	253

表目錄
表2-1、國際NIALM技術發展與商業模式的代表案例整理	26
表2-2、國際智慧電表分析與NIALM之商業化公司及其應用	64
表2-3、日本東電公司與美國Sense Labs公司產品比較	67
表2-4、東京電力、關西電力之NIALM加值服務方案比較	68
表3-1、電力信號定義	72
表4-1、問卷調查分析電器種類數量	144
表4-2、已建置的電器設備指紋模型分布	148
表4-3、設備模型與問卷調查分析最主要電器種類	160
表4-4、計算並找出五種電器不同時間區間的最大r值	160
表4-5、搜尋出最大r值相對應之電器指紋模型	161
表4-6、混淆矩陣(Confusion matrix)	163
表4-7、插座與迴路電表量測空調與電鍋耗電，計算F-Score結果	164
表4-8、國際文獻考慮近似住宅參數	166
表4-9、示範住戶實際坪數	167
表4-10、坪數X2的計算結果	168
表4-11、示範住戶的設備種類	168
表4-12、相同種類設備數量X5的計算結果	169
表4-13、X2與X5獨立分開之計算結果	170
表4-14、前期30戶示範住戶遷移模型驗證結果	170
表4-15、加入住戶坪數特徵𝑿2後更新模型，並計算準確度	172
表4-16、加入相同種類設備數量𝑿5後更新模型，並計算準確度	173
表4-17、台電公司VEE資料篩選方法	176
表4-18、示範住戶安裝插座電表的家電種類	178
表4-19、示範住戶遷移學習解析設備準確度	180
表5-1、前期與本期高頻穩態特徵NIALM技術開發之比較表	183
表5-2、前期計畫與後期計畫之成果分析比較	184
表5-3、示範用戶資料收集不全因素說明	188
表5-4、示範用戶測試期間表	188
表5-5、示範用戶全部家電辨識準確率與家電組合	189
表5-6、前期計畫與本期計畫全部家電測試結果	193
表6-1、本計畫招募共50戶示範住戶地點與房屋類型	198
表6-2、實場域試驗所需關鍵設備規格說明	201
表6-3、本計畫分析總用電與解析主要家電種類	215
表6-4、本計畫提出NIALM之商業服務應用情境	215
表6-5、台電公司VEE資料篩選規則	224
表6-6、參考台電公司VEE規則的用電量突升之發生數量統計	226
表7-1、鳳山實驗屋內主要家電無運轉時的用電數據	232
表7-2、國際文獻與本研究分析人的用電行為模式之比較	250
表7-3、兩位長者在家用電量之分兩群結果	251

第一章、緒論
1.1、計畫背景
研究數據顯示，我國家庭用電量逐年增加，顯見我國在用電分佈的使用情況中家庭用電需求的重要性，間接地帶動我國在經濟發展原動力，但也同樣的反應出電力能源管控與有效利用的相關議題，因為電力市場和一般金融市場的法則相同，同樣地重視供需平衡的問題，過去當需求增加時政府必須設法擴大電力能源的供給面廣設電廠。相反地，在面臨能源供給出現問題無法擴大供給面的同時，政府必須思考一個相當嚴肅的問題，即是如何教育人民如何有效的使用電力，發揮管控的最大效能與機制。
裝設智慧電表(Smart Meter)及建構先進讀表架構(Advanced Metering Infrastructure, AMI)，正是提高電能使用效率與實現電網智慧化的第一步。我國在推動未來智慧電網建置方面，經濟部針對其基礎設施所研擬之「智慧型電表基礎建設推動方案」已於民國99年6月底獲得行政院核定，正式啟動我國智慧型電表基礎建設的佈建計畫。同時該計畫亦已納入「綠色能源產業旭升方案」中的能源資通訊產業項目，將以建立自主AMI系統技術為目標。該方案之短期目標，主要在於透過具有節電誘因之時間電價機制，引導用戶主動節約用電，以降低尖峰負載及電力使用量；此外亦可帶動國內能源資通訊產業的發展。
依據衛生福利部統計處資料，2019年我國 65歲以上人口數達 360萬人，其中列冊65歲以上之獨居老人的人口數占全國總人口數的1.2%。目前衛福部針對這些獨居老人的關懷照護作法包括電話問安、關懷訪視、居家服務、餐飲服務、及陪同就醫等。這些作法之人力需求依賴性高，不但成本高更易有危險發生時無法即時發現之盲點。
針對獨居老人的居家活動照護，有別於安裝攝影機之影像監視及配戴穿戴感測裝置等侵入式活動偵測方式，日本東京電力公司應用NIALM技術提供非侵入式之居家活動偵測的商業服務，利用自行研發的電力傳感器所提供之即時用電特徵，利用機器學習(Machine Learning)演算法，以非侵入式方式解析出屋內家電之使用狀態，以偵測出居住於屋內之老人是否有用電行為異常之疑慮，此不但可減輕照護人力成本，顧及被照護者之隱私，亦可於突發性危險狀況發生時，即時通知救援。
非侵入式家電負載解析(Non-Intrusive Appliance Load Monitoring, NIALM)最初由麻省理工學院George W. Hart教授所提出的開創性研究[1-1]，主要是協助電力公司分析主要電器設備之運轉狀況，作為需量反應之先期潛力分析，系統架構如下圖1-1，應用人工智慧(Artificial Intelligence, AI)機器學習理論，將智慧電表提供之總電力資訊解析成各主要用電家電之用電負載組合，並提供相關之加值應用服務，為目前全球電業及相關電力大數據分析服務公司之技術發展主流方向，在全球電業自由化之發展趨勢，電力公司之經營策略會更加多元化，除應用電力大數據分析技術以提升售電品質外，亦可進一步提供非電業相關之加值應用服務，以應付多元化的商業競爭環境。

圖1-1、非侵入式設備負載監視(NIALM)方法架構
目前NIALM技術受限於需要建立各自用戶之用電解析模型、家電標籤與訓練，才能精準解析其細部用電，但於實際商業應用上無法如此進行，因此仿照影像辨識之技術發展經驗，透過遷移式學習(Transfer Learning)技術研析，利用已建立好之NIALM用電解析模型來解析非模型訓練用戶之用電，如此才能擴大NIALM技術之商業應用。
此外透過更精進之暫態電力特徵的擷取，建立各具可分辨性之家電運轉特徵指紋，來提升NIALM的辨識能力，以提供精準性要求更高之加值服務(如居家活動照護及用電安全等)，亦為目前全球NIALM技術之研究主流方向。


本計畫為跨年度計畫，如下圖1-2計畫工作項目分年列表圖，按照時程完成各分項工作，並於後續章節說明各個分項工作之細部執行成果。

圖1-2、計畫工作項目分年列表圖

1.2、計畫目標與架構
應用深度學習(Deep Learning)等最先進人工智慧理論，並配合其它非電力資訊，精進NIALM用電解析模型，以提升辨識精確度，並可於一定之連續時間區間內，即時解析出主要用電家電之用電負載組合，以提供NIALM之即時應用服務。
發展適用於NIALM之遷移學習技術，配合其它非電力資訊，利用已經建立好之實際家庭NIALM用電解析模型，經過模型參數調整後，以解析非模型訓練之智慧電表用戶之主要用電家電之用電負載組合，以利後續商業化推廣。
透過所發展之NIALM精進及商業化推廣之遷移學習技術，進行商業應用模式之實場域試驗，並規劃出後續異業結盟之商業合作模式及推動時程。

圖1-3、非侵入式家電負載解析技術精進與商業應用模式研究架構
本計畫架構如上圖1-3，首先進行3項NIALM商業應用技術發展研析，包括美、歐、日之商業應用案例，整理出細部技術需求規格與商業模式，作為開發技術與實場域試驗之參考；本計畫開發3項核心技術，包括高頻暫態特徵NIALM；高頻穩態特徵NIALM與低頻穩態特徵遷移學習，依3個實場域適合屬性進行試驗，包括於鳳山實驗屋進行家電高頻暫態特徵擷取實驗；建置高頻穩態電力特徵MQTT收集環境，作為50戶家居保全照護示範住戶的NIALM用電資料建模與異常用電分析平台，並探討NIALM與使用者行為關聯研究，以示範住戶為實場例應用；最後，應用低頻穩態特徵遷移學習技術，於100戶示範場域推廣HEMS智慧家庭，擴大智慧電表加值服務，協助民眾自主節電。
1.3、計畫成效
本研究計畫完成後，可達到如下成效：
協助台電公司建立國內高頻暫態電力特徵擷取技術，以提升NIALM之解析精準度。
協助台電公司建立國內NIALM之遷移學習技術，透過有限已經訓練好之NIALM用電戶用電模型，用以解析未經訓練之相似用電戶之家電運轉情形。
提升台電公司之AI電力大數據分析技術應用於非電業相關之加值服務能力。
透過實場域之技術實際應用，以評估商業模式之可行性，並達到台電公司未來與異業結盟之商業合作模式可行性。
1.4、國內外有關本計畫研究情形
(一) 美國NIALM領導廠商Bidgely，與全球約25家電力公司合作，包含PG&E、SCE、NV Energy、ComEd、E.ON等，應用其NIALM解決方案，協助電力公司客戶節省能源，以及提高參與時間電價以及電力公司節能措施之意願。
(二) 2014年Bidgely與PG&E合作，應用NIALM技術試驗時間電價對用戶能源使用行為的影響，提供844戶家庭用戶家電用電分析資訊。
(三) 2018年Bidgely與NV Energy合作，應用NIALM技術為NV Energy的客戶提供用能分析與個別家庭節能建議等服務。
(四) 由卡內基美隆大學獨力出來的NIALM技術新創EEme公司，應用NIALM技術以264個家庭用戶用電數據樣本(12個月每15分鐘一筆)，分析其空調、熱水器、乾衣機和洗碗機用電，能夠實現約70%的運轉辨識率。
(五) 2015年東京電力與日本NIALM技術公司Infometis合作，在300戶家庭用戶示範，NIALM技術的可行性。Infometis在配電盤上安裝傳感器，透過分析所蒐集到的電流波型建立每個設備的模型，並在雲端透過機器學習技術優化MIALM技術的準確度。2018年東京電力進一步與Infometis合資成立Energy Gateway公司，將運用AI+NIALM技術發展家庭物聯網(Internet Of Things, IoT)平台事業。
(六) 2017年中部電力與Bidgely及日本AI技術公司ABEJA合作，在40戶家庭用戶示範，運用智慧電表A及B -Route資料，來推定家庭用電分佈的準確性。示範結果發現大多數情況下，使用B-Route 資料預測精度優於A-Route，以冷氣為例，使用A-Route資料來推估的運轉辨識率為79.77%，使用B-Route 的運轉辨識率則高達91.55%。

第二章、國際最新NIALM商業應用技術發展調研
本分項工作為國際最新NIALM商業應用技術發展調研，包含美國、歐盟、日本共計至少三例有關NIALM之最新代表性商業應用案例，表2-1為國際NIALM技術發展與商業模式的最具代表的案例整理，包括NIALM學術研討會、領先發展公司、電力公司的商業模式等。由發展調研解析成細部技術需求規格，以及規劃出至少一項最適合台電公司發展之NIALM應用服務項目，並作為導入實場域商業模式試驗之參考。
表2-1、國際NIALM技術發展與商業模式的代表案例整理
2.1、美國Whole-House Energy Monitoring Systems-“sense”
美國公司Whole-House Energy Monitoring Systems-“sense”。Sense Labs[2-1]是位於美國劍橋的一間新創公司，提供家庭用戶基於非入侵式負載監控技術(Non-Intrusive Load Monitoring，NILM)，連結機器學習演算法的能耗追蹤服務，其主要特色在於極簡化用戶所需建置之硬體，透過行業領先的「超高頻率訊號取樣」掌握之精細用電數據，以「每秒1百萬筆數據取樣 [2-17]」，分析總用電中獨特的電源特徵開關範圍、設備運行時的突波與驟降，解析總電源中的”特殊噪音”是由那種家電產生，進行標籤，此產品隨著數萬家庭安裝，透過住戶協助識別家電，讓該系統的機器學習越來越進步。
在技術規格方面，Sense Labs公司使用大小約137mm x 66mm x 32mm之硬體設備作為非入侵式負載傳感器，重量約220g，屬於輕巧型產品。其中，無線通訊規格為802.11b/g/n Wi-Fi Bluetooth Smart，訊號處理之取樣頻率約1MHz，核心處裡器為1GHz ARM Processor，資料傳輸約每日300MB左右，產品示意如圖2-1所示(圖片來源：Sense Labs[2-1])。

圖2-1、美國Sense Labs公司的非入侵式負載監控產品
在住宅安裝方面，該公司強調為簡易安裝產品於配電箱內，如圖2-2所示(圖片來源：Sense Labs[2-1])，以無線傳輸上傳至雲端平台，並透過免費之iOS/Android apps，提供家庭即時用電資訊。

圖2-2、美國Sense Labs產品安裝於住宅配電箱內
	Sense Labs公司的家庭能源負載監控器利用智慧插座電表安裝於家庭電力系統中每個設備，並都具有一個標籤性的用電方法來檢測設備的運轉狀態。這些標籤皆為獨一無二。假設烤麵包機在打開時是家中唯一使用1,200瓦功率的設備，Sense可以只搜尋到總耗電量增加1200瓦的情況，並確定烤麵包機已開啟；當功耗降低1,200瓦時，Sense可以推斷烤麵包機已關閉，以此類推。
然而，家中可能有很多使用1,200瓦的設備，而且家中的大多數設備都比烤麵包機複雜許多。除此之外，烤麵包機中加熱元件之電阻會隨著溫度而增加，表示當烤麵包機加熱時，其使用的瓦數會下降，因此在它關閉時使用的功率不到1200瓦。Sense Labs公司使用比總瓦數更複雜的訊號處理演算法，使用之模型比僅判斷定性狀態開關要複雜許多。在訊號方面，圖2-3為該公司示範幾個不同設備之當前使用情況的一些電流波形(圖片來源：Sense Labs[2-1])。該公司表示這些波形中有大量可用的特徵細節，遠超出使用一般瓦數之計算。

圖2-3、美國Sense Labs分析烤麵包機負載電流曲線
烤麵包機屬於電阻性負載，其電流與電壓相位完全一致，具有非常穩定之關係。圖2-4為照明設備負載(白熾燈泡)，電流隨著電壓變化，如同烤麵包機的例子一樣。但是燈泡之鎢絲加熱速度比烤麵包機快許多，因此可以看到電流使用量僅在幾個週期內下降(每秒60個週期，因此下降發生在30-40毫秒內) (圖片來源：Sense Labs[2-1])。

圖2-4、美國Sense Labs分析照明設備負載(白熾燈泡)負載電流曲線
美國Sense Labs公司利用插座電表，以及安裝於配電盤之高頻訊號擷取之迴路電表，收集電流即時資料(原始資料)並傳送到雲端，分析原始資料並回傳到手機之app或是電腦，以利於客戶端了解自身家庭用電情況。在技術演算法方面，隨著時間作AI深度訓練學習，偵測設備之使用，並提供家庭之各設備能耗資訊。Sense Labs公司提供之服務如下：
即時追蹤能耗：了解住宅即時用電情況，進而自發性節電或改變尖離峰用電時間；
設定設備開關狀態提醒通知：透過App提醒住宅用戶設備開關狀態；
識別多餘能源浪費的來源：識別並建立能源負載基線，分析能耗所帶來之費用。
然而，Sense Labs公司認為NILM之技術與產品仍需克服以下挑戰與困難：
識別設備的學習建模時間
由於設備之耗能狀況與住宅使用者日常行為息息相關，若使用者行為改變，或是長時間不在家，大幅度改變總用電負載的情況下，訓練學習模型之時間則會增加，複雜度也會提升。
標籤設備的成本
即使使用插座電表量測收集電流等訊號，仍需住宅客戶端自行標籤其插座電表所對應到的家電設備，若插座電表改變位置或是改變量測的設備，同樣需重新訓練學習模型。



2.2、美國-Grid4C智慧電網分析服務公司
美國Grid4C公司[2-2]由Noa Ruschin-Rimini博士於2013年創立，其願景是利用AI人工智慧和機器學習從智慧電表和物聯網設備中取得最大的商業價值，在短短幾年內，已擴展到 4 大洲，並與全球公用事業公司合作分析數十億電表和智慧設備讀數，每天提供數百萬次預測，迄今，已成為能源行業排名第一的預測分析解決方案提供商，該公司之網路服務平台如圖2-5所示(圖片來源：Grid4C[2-2])。

圖2-5、美國Grid4C公司網路服務平台示意
隨著各國都市化與土地開發的過程，氣候變遷、地球暖化現象越來越明顯，全球開始著眼於節能減碳及環保議題，智慧能源概念也因此誕生，而能源管理系統成為重要的關鍵之一。據Smart Energy International指出，以色列具有多元化的新創企業，該國政府於2016年建立的創新局(Israel Innovation Authority)宣布將補助能源業者Grid4C公司開發新演算法用於智慧電表。
Grid4C的演算法將整合到智慧電表中，並在電網邊緣做出即時決策。Grid4C解決方案為公營企業推出即時用電預測、分散式發電最佳化、家庭能源管理與電器故障診斷服務。未來將有助於改善營運模式，降低尖峰需求量，進而達到節能之效益；此外，該公司在2019年5月表示與瑞士智慧電表Landis+Gyr合作，透過創新解決方案給予用戶數據管理建議，兩間公司也積極擴展業務至澳洲、香港與紐西蘭，協助公營事業提升能源使用效率。
該公司最著名之服務系統為預測家居顧問(Predictive Home Advisor)，Predictive Home Advisor解決方法為使用AI機器學習演算法，為電力消費者提供所需之即時資訊，幫助預防未來的問題並節省資金，從而最大限度地為客戶和電力供應商創造價值。主要服務內容如下：
家電故障檢測與診斷(Appliance Fault Detection and Diagnosis)
Grid4C的演算法可以檢測、診斷並在許多情況下預測許多家用電器的故障、低效和行為異常，其中包含暖通空調系統、熱水器、泳池泵和冰箱等，僅只需分析智慧電表之大數據資料。
非侵入式設備負載分解(Non-Intrusive Appliance Load Disaggregation)
透過分析來自每個家庭的智慧電表使用數據，Grid4C的演算法可以以非侵入性的方式為客戶分解每個設備的能源使用情況，並在檢測到異常高的設備使用或成本異常時提醒客戶。除此之外，機器學習模型可以在各種條件下(天氣條件、節假日、星期幾、一天中的時間等)監控和學習每個客戶的使用模式。藉由這些使用行為模式資料，該公司可以監控客戶的實際使用行為以自動檢測使用偏差。
帳單和使用預測(Bill and Usage Forecasting)
Grid4C的演算法為每位客戶建構預測模型，預測客戶的行為方式以及未來 31 天他們的每台設備將消耗多少能源，並根據天氣進行標準化。而客戶可以查看未來一周的預測每日成本和用電量，進而自發性節能節電。除此之外，這些模型還可以一小時為間隔生成每日和每週預測用電量。
智慧恆溫器優化(Smart Thermostat Optimization)
透過將客戶使用數據與智慧恆溫器數據相結合， Grid4C可以幫助客戶優化恆溫器設置，模擬任何溫度設定對客戶能源帳單的影響，並預測和檢測有故障的家用電器，以提供真正的客戶價值。
聊天機器人(Chatbots)
Grid4C開發創新的聊天機器人，透過聊天窗口進行自動互動，當有多種可能的解釋時，使用機器學習向客戶提出 2-3 個問題以診斷或解決問題。



2.3、美國Bidgely Inc.的B2B2C商業發展應用
Bidgely公司[2-3]是NIALM技術發展的領先者，以B2B2C方式協助電力公司轉型為能源使用的諮詢者，藉以改善顧客滿意度，提升顧客參與度與能源使用體驗。以下說明Bidgely公司具特色之商業應用案例。
美國太平洋瓦斯與電力公司(PG&E)用電資訊加值之節電服務
太平洋瓦斯與電力公司(PG＆E)是美國最大的公用事業之一，在加州北部和中部的7萬平方英里服務區域內，為大約1,600萬人提供天然氣和電力服務。
2014年Bidgely與PG&E合作，使用Bidgely 的HomeBeat 服務，示範時間電價與HAN對用戶能源使用行為的影響，進行智慧電表對於實時用電與電費資訊的影響評估，並為約850戶的家庭用戶提供家電用電分析資訊。
當時，PG&E從SmartRate方案與時間電價方案的申請用戶中招募示範用戶，提供實時能源監控與成本信息影響的相關資訊。此外經由Share My Data 機制傳輸，使用戶和第三方皆可以通過應用程式介面(Application Program Interface, API)取得用電數據，等同於用戶授權第三方使用其用電資料。
美國加州政府針對電業有要求節電義務，因此該方案對用戶而言，是免費參與的。但Bidgely 有另向公用事業收取每戶每月$0.50美金之費用。結果顯示，示範用戶透過實時能源監控服務(Stream My Data)可節省多達7.7%的用電量。此外超過80%的示範用戶表示他們會將該服務推薦給親友。


美國聯邦愛迪生電力公司(ComEd)用電資訊加值之節電服務
美國聯邦愛迪生電力公司(ComEd)是總部位於芝加哥的艾索倫電力公司(Exelon Corporation)的子公司，是美國伊利諾伊州最大的電力供應商，為芝加哥都會區及伊利諾伊州北部的唯一電力供應公司，擁有大約780萬客戶。ComEd為伊利諾伊州北部約380萬客戶提供服務，佔該州人口的70%。 
2015年，Bidgely與ComEd一同合作進行為期六個月的示範計畫，試點期間邀請250名用戶一起測試新型HomeBeat™能源監控器，透過此監控器收集ComEd智慧電表資訊並即時傳送至Bidgely雲端平台。此外另有2,500名參與者使用HomeBeat™Web＆Mobile平台，可得到個人化的家庭能源報告，並詳細說明何時使用能源。
自2016年6月1日至2017年12月31日，ComEd亦展開為期18個月的EE與DR方案，該方案邀請1,218名家庭用戶，每位參與者按每小時、每天、每月等時間單位收到能源使用消息，如加溫負載、空調負載、游泳池泵負載、及始終開啟負載等設備狀態，節約能源的技巧與建議，以及查看當前結算週期的實際與推估電費。
其中的36位用戶亦收到HomeBeat家庭區域網設備，可進一步即時查看能源使用情況。結果顯示，1,218名家庭用戶每日用電量平均降為17度，平均約節省1.1%用電量，共計節省99,586度。當時，參與者比較傾向透過網站查看能源使用情況，網站查閱利用率(93%)高於手機查閱利用率(33%)。
美國NV Energy用電資訊加值之能源查核應用
2018年Bidgely公司與NV Energy合作，運用NIALM技術，將為NV Energy的客戶提供用能分析與個別家庭節能建議等服務。其服務內容包含設備用電解析、家庭能源評估調查、現場審核員工具、顧客服務共同瀏覽服務、目標式參與專案等。設備用電解析可提供個人化建議和警示。家庭能源評估調查利用預先填寫問卷調查，使得設備用電解析準確率達到80%。
現場查核員工具用於收集居家能源查核數據，該數據會自動同步到總部的相關數據庫。顧客服務共同瀏覽服務允許客服中心可查看與客戶所見的相同數據，並搭配電訪溝通，以求積極解決。目標式參與專案可針對特定用戶進行居家能源查核。
澳洲聯合能源公司(United Energy)用電資訊加值之需量反應服務
澳洲聯合能源公司位於維多利亞州芒特韋弗利區，為配電服務商，服務超過64萬用戶。該公司期望能在夏季針對住宅用戶進行相關抑低尖峰措施。因此2016年與美國Bidgely公司合作，執行行為需量反應(Behavior Demand Response)解決方案。
該方案透過電子郵件、行動聯網(HomeBeat mobile app)、及智慧電表傳遞個人化需量訊息。特色為透過遊戲化訊息設計，以吸引用戶在需量反應事件期間，全程維持參與動機。並根據個人歷史用電行為設定此一DR事件的抑低需量目標，Bidgely可提供實時用電數據，讓用戶清楚了解是否達成抑低需量。在需量反應期間提供誘導性回饋，會以三小時為抑低事件單位，設計每一小時達成抑低目標的誘因，每小時都達到設定的目標時，即可得到更多的獎勵回饋，如圖2-6所示(資料來源：Bidgely 官方網站[2-3]，本研究整理)。

圖2-6、澳洲聯合能源公司行為需量反應解決方案


2.4、歐洲利用智慧能源數據進行遠端居家照護之研究
根據歐洲20/20health期刊在2020年11月發表的Smart Future of Healthcare論文[2-4]，說明目前歐洲的國民健康研究單位開始朝向研究智慧電表數據在健康和護理支持方面的可能性，如圖2-7。該研究發現能源使用模式與健康狀況、健康變化和總體福祉相關。利用家庭用電的非侵入式負載監測(NIALM)技術，可以識別各種電器的使用，再利用機器學習建立常規行為和活動地圖，即可及早檢測使用者異常行為或意外的不活動狀況(Early Detection of Dementia)。

圖2-7、歐洲20/20health期刊發表智慧電表數據於健康和護理支持
若一個人偏離正常的作息時間可以監測出潛在的身體健康問題。例如在夜間使用熱水壺或其他電器，可能表示與神經系統惡化、或精神健康問题有關的睡眠障礙。晚間和夜間用電量的增加可能表示與日落綜合症有關的激動、困惑和不安，是失智症的一個徵兆。反覆忘記關閉烤箱或其他電器，可能表示與精神健康惡化或輕度認知障礙有關記憶問題。以下說明利用智慧能源數據進行遠端居家照護的發展依據。
對體弱的個人家庭監測/術後護理或修護性護理的家庭監測
使用智慧能源數據和NIALM來進行健康和護理研究仍處於早期階段，目前的作法是利用家庭用電非侵入式負載監測來識別各種電器的使用狀態，由個人偏離正常的作息時間來了解其身體健康問題。未來的延伸應用除了智慧電表可以結合天然氣和用水資訊，可以對日常生活活動有更深入的了解。
人口層面的篩查和監測
智慧能源（天然氣和電力）數據顯示的能源消耗模式，與住房數據和歷史天氣數據一起分析，可能提供足够的訊息，以實現遠端檢測寒冷的家庭和不健康的生活環境。通過使用水的使用數據，以及家庭中的智能濕度感應器來檢測潮濕的生活條件，可以進一步加强洞察力。鑒於能源部門在識别客户的潛在脆弱性方面的現有責任，它可以在人口層面的篩選中發揮重要作用。
自我監測，以確保福祉和安全
自我監測是智慧家庭能源管理系统(HEMS)的核心。這些系统通常通過應用程序進行通訊，目的在使消費者更具能源意識，並讓他們對家中的智慧家電設備有更多的控制。HEMS可以在許多方面促進消費者的福祉和安全。智慧電表可以通過家用顯示設備(IHD)提供幾乎即時的能源使用和支出訊息，這意味著消費者可以更好地管理他們的能源消耗，節省能源費用並減少碳排放。
歐洲20/20health期刊在2020年11月發表的Smart Future of Healthcare期刊有提出以下實際應用案例，說明如下：
Informetis之NIALM家居照護服務至英國進行試驗
Sony的衍生(spin-off)公司Informetis已經與能源供應商東京電力公司合作，在日本推出了用於非正式護理監測的NIALM應用。Informetis的NIALM技術不僅能檢測到高耗能的電器，也能檢測到電視機等低耗能的設備。其目標用戶是那些年邁且通常在居住在異地的父母，其子女等家庭成員可獲得父母的生活作息是否有異常狀況發生。
Informetis在英國劍橋設置歐洲研發中心，展開第一個試驗計畫，作法為監測6棟單身住戶的房子，安裝智慧插座進行數周的機器學習建立使用者的用電模型，再移除智慧插座並安裝電流傳感器來實現NIALM技術應用。監測警報聯繫人為家庭人員或護理人員，目前已在歐洲進行實場驗證，計畫在2021年後進行商業推廣。
Solgenium之NIALM臨床應用
Solgenium主要專注於NIALM的臨床應用，並且正在測試作為獨立解决方案以及與天燃氣、水和其他可能源數據相結合的能力。Solgenium的數據融合和機器學習過程被設計為直接向臨床醫生提供臨床相關訊息，或根據檢測到的健康狀况變化生成自動臨床預約訊息。Solgenium與Wien Energie (奥地利最大的區域能源供應商)和醫療機構合作，研究哪些臨床學科和病人狀况可以從NIALM分析中受益，以及NIALM如何有助於提高醫療水準。
Solgenium第一個試驗中，有25名參與者使用NIALM繪製的睡眠模式，並且跟踪睡眠藥物的有效性，這是因應參與者白天生活作息的各種情况，如憂鬱症、倦怠、神經退行性疾病而開出的處方。並且與能源供應商Wien Energie和睡眠實驗室合作，根據由一秒鐘間隔的智慧電表數據組成的數據集與來自可穿戴設備的數據和經過驗證的睡眠日記進行標記。
另外Solgenium也從每15分鐘的智慧電表數據利用機器學習演算法建立人工智慧模型進行標記的結果在某些睡眠健康指標上與可穿戴睡眠追踪器的結果相當。因此在第一個試驗後提出不需要一秒鐘間隔的數據。
Solgenium於2020年夏天進行第二個試驗，招募至少1000名參與者，第二次試驗分析的數據來源，包括電力、天然氣、水和互聯網使用數據，以測試出最具臨床訊息的組合。
最先進的環境輔助生活系統(Ambient Assisted Living, AAL)將家庭感測器、智慧插座和可穿戴式設備與機器學習軟體相結合，以實現對獨居老人或弱勢人群的遠端監控。通過監測家庭周圍的活動和廚房電器的定期使用，該系統可以推斷和繪製行為常規和日常生活活動(Activity of daily living, ADL)。當檢測到異常行為時，會自動發出警報，並發送給家庭成員、護理人員、遠端保健中心或臨床醫生，以作出回應和調查。
目前英國已經有此監控系統出現在非正規護理環境中。NIALM技術的成功率各不相同，主要是因為被監測的設備屬性和有多少設備，以及有多少設備同時被使用等因素影響。NIALM的研究重點是檢測高耗能電器，如水壺、烤麵包機、微波爐、電烤箱和洗衣機，因為這些電器更容易檢測，在大多數家庭中很常見，而且經常使用。
最重要的日常生活活動(Activities of Daily Living , ADL)有包括洗澡、穿衣、吃飯、喝水、娛樂、走路和使用廁所等生活作息。由此可見並非所有的日常生活活動(ADL)都可以通過能源使用模式推斷出來。然而，由於NIALM捕捉到了準備食物和飲料以及洗衣服的證據，它通過這些行動假設了一定程度的移動性（即獨立居住者）。它還可以映射出白天不活動的時期，即居住者經常外出，例如參加每周的社交活動。因此，即使没有額外的環境輔助生活設備（如運動感測器），NIALM對日常活動和日常生活活動(ADL)的洞察力也是相當大的幫助。



2.5、日本關西電力公司生活方式節奏通知服務
日本關西電力公司[2-5]推出以智慧電表應用於家居觀護的商業應用方案，名為「生活方式節奏通知服務(Lifestyle Rhythm Notification Service)」，從2017年起開始受理智慧電表用戶申請。有以下三個申請條件：
1.	用戶已與關西電力公司簽訂購電合約
2.	家中已安裝智慧電表
3.	用戶需成為關西電力照護方案之會員
關西電力照護方案(はぴe まもるくん方案)之用電量數據免費服務，是利用用戶家已安裝的智慧電表AMI，不需額外花費安裝遠程監控設備。而當受照護者家中用電發生變化時，該服務會透過郵件發送通知。發送郵件通知有三種情況：
1.	當一天用電的開始不同於平常
2.	如果一天用電的結束時間與平時不同
3.	用電量有一定百分比變化時（每3小時）
關西電力照護服務的運作模式，是累積過去30天之每30分鐘的用電數據，建立生活常態模型，並在用戶發生用電變化(異常)時發送通知。根據用電量的變化，來推測與電力使用相關的”生活節奏(日常生活活動)”，如下圖2-8(圖片來源：日本關西電力公司[2-5])。由於平日容易接收大量訊息，因此，僅在可能發生異常時才接收通知為一項特色。

圖2-8、關西電力(はぴe まもるくん方案)推測電力使用”生活節奏”
如上圖2-8所示，為當日生活節奏判定，圖中綠線(圖2-8右方上圖)為以推定之用戶生活模式，紅線(圖2-8右方下圖)為根據當天用電量資訊來確認用戶的生活節奏。而判定異常是依據電力使用量變化；因使用家電行為改變所引起的一定比例用電量變化，例如電飯鍋、吸塵器等。
另外，當發生生活節奏的異常而電力使用時間的變化，例如，原本在早上使用洗衣機、電視等，轉為中午時段使用。根據平時生活節奏，生活節奏發生異常或電力使用量有一定比例變動將發送通知。但用戶若使用電熱水器等夜間蓄熱式設備時，深夜時段的電量都會增加，因而不在發出通知的範圍內，且該服務並不提供家中裝設太陽能發電設備。
日本關西電力公司的生活方式節奏通知服務(Lifestyle Rhythm Notification Service)是與富士通公司[2-6]合作，關西電力公司希望提供加值服務以維持客戶關係，看中富士通公司的具有數據分析能力，協助使用人工智能分析智慧電表的數據來確定個體居民的生活方式。當居民的用電偏離正常行為時，會發送通知予其家人，關西電力公司希望由這服務可以觸發子女與長者的聯繫。
富士通公司利用人工智能和其他先進技術，以加强與合作伙伴的關係，就是需要與個人家庭面對面服務的公司，可以提供越來越多的高附加價值服務，例如送貨上門、入戶訪視等。
如下圖2-9，為日本關西電力公司(KEPCO)與富士通公司(FUJITSU)合作的生活方式節奏通知服務之分析架構[2-6]，流程說明如下：
1. 每30分鐘智慧電表數據
2. 電表數據協作(加密)
3. 傳至富士通AI平台進行數據分析
- 邏輯建構: 分析每個家庭30分鐘數據來優化各自的邏輯
- 邏輯執行: 分析每30分鐘數據，並比較之前與之後，上升、持平、下降
4. 傳回關西電力(加密)
5. 警報判斷
6. Email警報通知使用者與遠端照護者

圖2-9、日本關西電力公司的生活方式節奏通知服務之分析架構
當被照護者的用電行為偏離正常行為時，就會發出信息通知他或她的家人，家人可能住在其他地方，關西電力公司使用富士通的AI數據服務來分析數據，所提供的5種照護情境說明如下：
1. extremely low electricity charges, 極低的電費
2. the prominence of certain trends, 某種趨勢發生突起變化
3. large variations between users, 用戶之間的巨大差異
4. high early-morning and daytime use, and 清晨與白天的用電量很高
5. plenty of use at night. 晚上用電量高


2.6、日本東京電力公司遠處亦安心(遠くても安心)遠端觀護服務
日本應用NIALM技術之代表性電業首推東京電力集團，因應電力自由化，東京電力公司轉型為東京電力控股公司，並拆分其發電部門、輸配電部門、零售部門、以及再生能源發電部門為不同的子公司，分別為東京電力燃料及電力株式會社(東京電力フュエル＆パワー株式会社，簡稱東電FP)、東京電力電網株式會社(東京電力パワーグリッド株式会社，簡稱東電PG)、以及東京電力能源夥伴株式會社(東京電力エナジーパートナー株式会社，簡稱東電EP)。東電FP負責火力發電與燃料調度，東電PG負責輸電與配電，東電EP負責售電業務、並跨足家用瓦斯供應。其中與NIALM技術應用相關的子公司為負責電力零售業的東電EP。
為因應外部環境變化，如電力自由化、少子化、低碳化等因素，所造成的電力販售競爭激化、電力需求減少、低碳要求，東電EP採取事業領域擴大策略，包含天然氣銷售、新能源擴展、節能、節省成本、及減碳的商業模式、可再生能源銷售業務模式、以及海外業務推展。
東電EP[2-7]與Informetis公司合資成立智慧傳感器株式會社(Energy Gateway)，東電EP持股60%，Informetis公司持股40%，如圖2-10所示。Energy Gateway成立目的為結合先進NIALM分析技術與電力零售服務提供用戶更加安全、便利、自由、愉悅的居家生活。

圖2-10、東電與Informetis合資成立Energy Gateway
以下說明東京電力公司應用NIALM技術所提供的遠處亦安心(遠くても安心)遠端觀護服務、NIALM傳感器應用研析、北海道新商業服務「AI見守」，與國立心血管研究中心預防醫學和流行病學系合作等應用研析。
(一)遠處亦安心(遠くても安心)遠端觀護服務
遠處亦安心(遠くても安心)遠端觀護服務[2-8]即是應用NIALM技術分析家電使用情況，主要家電如空調、電鍋、微波爐、洗衣機、吸塵器、電熱家電(如加熱器、烘乾機、熱水壺、IH爐等)，提供「無壓力觀護」的居家安全服務，如圖2-11所示。

圖2-11、日本東電遠處亦安心遠端觀護服務-8種家電使用狀況通知
如圖2-12所示，欲訂購用戶(如子女、親屬等)須與被觀護長輩進行溝通，與長輩確認且同意參加遠端觀護服務。當長輩同意後，訂購用戶須先行確認被觀護場域的網路環境，如FTTH、ADSL等的Internet線路和無線區域網路環境。再者，雙方約定傳感器裝設日期時，會派員前往用戶處入戶安裝傳感器，安裝時間約花費1小時。裝設完成後，家電分離推定技術需要約10天的學習生活模式，學習模式結束後，即可開始利用該服務。

圖2-12、遠處亦安心遠端觀護服務-入戶安裝流程
遠處亦安心遠端觀護服務的服務內容包含如圖2-13所示之當前狀態、每日報告、每周報告等三大服務，並說明如下。當前狀態服務即是在時間軸上顯示最近使用過的家用電器和使用時間，「約在18:40，使用微波爐。」，「約從17:10開始，打開電視約3小時50分鐘。」，「約從21:30開始，打開空調約50分鐘。」。
每日報告服務即是分析家用電器的日常使用趨勢並提供評論，將一天24小時以深夜(0時~5時)、早晨(5時~10時)、正午(10時~15時)、傍晚(15時~20時)、晚上(20時~24時)等五大時段切分，以圖示將該時段的使用家電可視化，亦提供該時段電力使用量的圖示變化，並提供該日的天氣資訊與歷史資料比對後的異常提醒，如「晚上經常使用的電視，今天卻很少使用」。
每周報告服務亦是分析家用電器的日常使用趨勢並提供評論，以一周為單位並將五大時段以顏色作區分，顯示每日那些家電使用在那些時段，並提供該週的天氣資訊與歷史資料比對後的每週異常提醒，如「空調使用時間比平常更長。最近，每週平均使用約11小時20分鐘，本週卻約使用30小時40分鐘」。

圖2-13、遠處亦安心遠端觀護服務- App畫面
遠處亦安心遠端觀護服務亦提供如圖2-14所示之4種情境服務，包括：
1. 避免中暑(空調未使用則建議使用)
2. 半夜使用家電(使用時段不合適)
3. 較少使用(16小時內應該使用而沒有使用)
4. 長期使用(有線吸塵器使用時間過長，超過3小時)
中暑避免情境服務即是長者居住區域的中暑警告等級提高，但長輩似乎還沒有使用空調，可能有中暑疑慮，家屬可打電話關切並提醒長輩保持居家通風或是開啟空調降溫。深夜使用家電情境服務即是長者最近時常深夜使用電器，生活節奏與既往不同且已改變，家屬可打電話關切長輩最近的生活狀況。
家電長時間開啟情境服務即是家電異常長時間作動，如吸塵器持續開啟超過3小時，長者是否忘記關閉電器，家屬可打電話關切長輩當下的活動。長時間未用電情境服務即是長者已超過16小時未用電，可能是長期外出或出遊，但未告知家屬，家屬可打電話關切長輩當下的活動。

圖2-14、遠處亦安心遠端觀護服務-4項情境服務
(二) 日本東電的NIALM傳感器技術研析
如圖2-15為日本東電的遠處亦安心遠端觀護服務所需的關鍵元件-NIALM傳感器，由Informetis官網[2-9]所公開的規格得知，資料傳輸速度(Data transmission speed)高達65Mbps，採用2.4Ghz無線通訊，具有4個電流感測(Current Transformer, CT)輸入，體積小可放入日本住宅的開關箱內。

圖2-15、日本東電NIALM傳感器外觀與公開規格
如圖2-16為所蒐集到的已公開傳感器硬體規格[2-10]，重要資訊有，該硬體為工業級電腦核心為800Mhz，有6個Ch, 14bit ADC輸入，訊號擷取頻率為 250K data/s，可外接4個CT包括L1, L2, PV與儲能，具無線傳輸功能，此工業級電腦為Linux核心之Ubuntu作業系統，可客製化應用程式。

圖2-16、日本東電NIALM傳感器硬體規格
Energy Gateway於2018年由日本東電公司與Infometis合資成立，以B2B模式服務日本市場，其平台可接收第三方IoT傳感器數據，採用Google雲端平台方案。
下圖2-17，因應日本國家政策2030年全面導入HEMS家庭能源管理系統，政府補助住宅安裝HEMS與蓄電池，帶動企業發展支持不同廠牌的ECHONET Lite標準蓄電池，Energy Gateway提供家用蓄電池AI優化控制系統[2-11]，從功率傳感器採集到的詳細電量數據，利用Infometis開發的AI算法，可以協助住宅準確預測家庭太陽能發電量和自宅用電需求，控制蓄電池充放電，優化電費支出。

圖2-17、Energy Gateway家用蓄電池AI優化控制系統
如下圖2-18為Informetis所公開的NIALM技術簡報[2-12]，「電力數據和機器學習使用單個傳感器輕鬆可視化您的家」之重點摘要，說明家電分離技術研究和發展的方法，可得知NIALM傳感器安裝在住宅開關箱內，透過Wifi上傳數據，以每1秒傳輸電流波形數據，經由雲端NIALM解析家電運轉狀態，透過服務提供者如東京電力公司，服務其客戶。

圖2-18、Informetis -電力數據和機器學習使用單個傳感器
如圖2-19為Informetis的NIALM公開技術[2-12]說明家電分離技術研究和發展的方法，從住宅開關箱一個地方測量的電功率數據，經由估算模型，分離出個別電器的運轉狀態，包括空調、電子爐、洗衣機等。

圖2-19、Informetis -家電分離技術研究和發展的方法
Informetis所應用的機器學習技術包括以下三個面向：
家電特徵
包括：事件觸發Event Based之家電ON/OFF；狀態改變State Based之家電運轉過程中的過渡和變化模式。
學習與訓練方法
分為：使用監督式Supervised學習技術，於分電盤主用電開關，安裝單個家電測量傳感器以收集數據；
非監督式Unsupervised學習，由用戶自己標籤電器的名稱。
機器學習演算法
可應用的演算法包括隨機森林、隱藏式馬可夫模型HMM、深度學習等，要考量可獲得的數據、家電特徵、使用案例等，是具有挑戰性的研究領域。
Informetis公司對於自身NIALM技術開發與應用的定位說明[2-12]，如下圖2-20，橫軸座標以訊號解析度為發展頻譜，左邊為大部分以智慧電表與雲端處理每分鐘等級解析度的公司案例，右邊為使用特殊傳感器與本地端高解析度的公司案例，而Informetis公司具有高精度分離技術並與智慧電表有良好的兼容性。

圖2-20、Informetis公司NIALM發展定位



(三)從東京至北海道擴展遠端觀護服務
2021年1月7日，日本東京電力公司授權合作業者ヤブシタエネシス株式會社，於北海道提供新商業服務「AI見守[2-13]」，新聞稿如圖2-21。

圖2-21、ヤブシタエネシス株式會社提供新商業服務「AI見守」
ヤブシタエネシス株式會社屬於售電業，是因電力自由化而進入市場的新型電力公司，提供售電服務、設備能效、汰換及販售、電力可視化、自動控制系統等，「AI見守」是新的商業服務[2-14]，如圖2-22，與東電公司的遠處亦安心(遠くても安心)遠端觀護服務完全相同，只是網頁色調差異，同樣提供入戶安裝傳感器，分析8種家電運轉狀態之4種照護情境，每月資料傳輸量為3GB。

圖2-22、ヤブシタエネシス株式會社之「AI見守」服務內容
(四) Informetis公司於歐洲展開NIALM試驗計畫
2021.06.18，BBC NEWS新聞媒體採訪，「Could my mum’s toaster help me care for her?」[2-15]，說明Informetis公司於歐洲展開試驗計畫，提供名為Infocare的服務，使用非侵入式負載監控NIALM的技術。新聞採訪其中一位示範住戶的子女參加試驗的心得感想，內容摘要如下：
每一秒，我父母電表箱中的傳感器都會測量來家中的電力信號，進行採樣並將信息發送到雲端。演算法會檢查信號上的噪聲，以確定正在使用哪些家用電器。（目前，僅使用智慧電表還無法做到這一點，因為是英國智慧電表是每30分鐘測量一次電量）
這個通知可能會促使我打電話給他，看看他那天是否記得吃過飯
Informetis總裁說：我們的技術完全是為了讓您安心
該技術仍處於試驗階段，使用有限的設備數據庫
小規模測試，仍有精進空間(部分設備似乎被誤認為是電熱水壺)
(五)東電公司與國立心血管研究中心預防醫學和流行病學系合作
日本東京電力公司2021年10月8日發布，與國立心血管研究中心預防醫學和流行病學系合作[2-16]，研究背景為因應超高齡化社會的日本，失智症患者的人數不斷增加，該計畫從2019 年 4 月至 2020 年 7 月，由宮崎縣延岡市 65 歲及以上老年人參與研究，住戶的電力使用數據由東京電力公司的子公司 Energy Gateway 提供的高精度電力傳感器進行收集和解析。
電力數據解析包括各大家電：IH電磁感應爐、微波爐、空調、冰箱、洗衣機、吸塵器等的使用情況，如圖2-23，經數據分析，認知障礙組的IH電磁爐使用時間更短、微波爐在春季和冬季使用時間更短、空調在冬季的使用時間更短，研究成果表明可從家用電器的使用狀態預測長者是否有認知衰退(圖片來源：[2-16])。
在家中監控家用電器的使用情況是一種簡單的方法，對受試者的身心傷害較小，因此它已被確立可早期發現認知衰退和障礙的方法之一。

圖2-23、醫學研究家電的使用時間分析長者認知障礙
由上述研析整理日本東電公司與Informetis公開資料研析，其NAILM關鍵傳感器是工業級電腦核心，每1秒傳輸特定電力參數，經由雲端平台進行NIALM解析家電運轉ON/OFF狀態，主要解析8項家電，經由10天學習，可提供4種照護情境之Email通知。
日本東京電力公司的遠端觀護服務從東京擴展至北海道，並於歐洲展開試驗計畫，且與醫學中心合作，可得知東京電力公司對於NIALM應用於家居照護的重視程度與發展現況。


2.7、美、歐、日之NIALM商業應用案例分析歸納
本分項工作完成國際最新NIALM商業應用技術發展調研，包含美國、歐盟、日本共計至少三例有關NIALM之最新代表性商業應用案例，包括NIALM學術研討會、領先發展公司、電力公司的商業模式、細部技術需求規格等。
由國際案例發展調研，可歸納各國應用NIALM的應用發展方向如下：
美國-用電揭露自主節電
歐洲-認知障礙臨床研究
日本-用電作息異常通知
下表2-2為本研究收集與整理國際提供智慧電表分析與NIALM之商業化公司及其應用服務列表。
表2-2、國際智慧電表分析與NIALM之商業化公司及其應用
下表2-3為日本東電公司NIALM傳感器與美國Sense Labs傳感器綜合比較整理。
表2-3、日本東電公司與美國Sense Labs公司產品比較

資料來源：本研究整理


下表2-4分析比較日本東京電力、關西電力之NIALM加值服務方案相關內容，包含所服務對象、所需設備與啟動通知的方案內容，可作為本計畫協助台電公司規劃未來NIALM商業服務之參考。
表2-4、東京電力、關西電力之NIALM加值服務方案比較
資料來源：本研究整理
本計畫參考日本東京電力公司與關西電力公司的遠端觀護商業服務，朝向「用電作息異常通知」的應用方向，整理成本計畫的細部技術需求規格，6種照護情境整理如下：
半夜使用(使用時段用電量過高不合理)
較少使用(16小時內沒有使用，極低的電費)
用戶用電量之間的巨大差異
某種用電趨勢發生突起變化(參考台電公司VEE規則)
怕中暑(戶外溫度超過36度，空調未使用則建議使用)
長期使用(電器使用時間過長，超過3小時)
上述第5項與第6項情境，是以電器為目標，可透過第三章與第五章的NAILM技術解析。第六章說明第1~4項情境進行實作模擬。

第三章、高頻電力特徵NIALM技術開發
由數據可以明顯得知我國目前在家庭用電戶數方面是佔所有總用電數為大宗，而且每年的用電需量亦逐年的增加，顯見我國在用電分佈的使用情況中家庭用電的重要性，間接地逐年帶動我國在經濟發展原動力的提升，但也同樣的反應出電力能源管控與有效利用的相關議題，因為電力市場和一般金融市場的法則相同，同樣地重視供需平衡的問題，過去當需求增加時政府必須設法擴大電力能源的供給面廣設電廠。相反地，在面臨能源供給出現問題無法擴大供給面的同時，政府必須思考一個相當嚴肅的問題，即是如何教育人民如何有效的使用電力，發揮管控的最大效能與機制。
所以想要有效的管控及使用電力，並落實節能減碳成效，建構智慧型電網(Smart Grid)，以及完整穩定的電力能源監測與管理系統，就成為所有國家及產業最重要的政策及目標。設置智慧電表(Smart Meter)及構裝先進讀表架構(Advanced Metering Infrastructure, AMI)，正是提高電能使用效率與實現電網智慧化的第一步。我國方面，在推動未來智慧電網建置，將以建立自主AMI系統技術為目標。短期目標，主要在於透過具有節電誘因之時間電價機制，引導用戶主動節約用電，以降低尖峰負載及電力使用量；此外亦可帶動國內能源資通訊產業的發展。
讀表架構首重電力特徵分類與分析，依據電力信號的處理方式不同可以區分為穩態特徵及暫態特徵，如表3-1所示。有鑑於電力特徵於穩態(Steady State)的情況下，當負載並聯使用時具有加成(Addition)的特性。因此，若要在穩態系統中辨識出各個負載，事實上有其困難。故提出使用小波轉換(Wavelet Transform, WT)的分析如離散小波轉換(Discrete Wavelet Transform, DWT)作為負載辨識的特徵萃取技術，因小波轉換具有處理非穩態與暫態信號、同時分析時頻域信號及解析信號的局部特徵等特點。若此，便可提高對負載的辨識能力與精確度、縮短辨識所需的時間及減少資料處理所占記憶體容量，並克服使用穩態特徵於非侵入式負載辨識的困難。
本分項工作之目標為發展高頻暫態電力特徵之取樣技術，並配合機器學習演算法，建立高準確度之NIALM用電解析模型，以提升傳統NIALM模型之用電精準度。以下就本計畫之執行方法加以說明。
表3-1、電力信號定義



3.1、高頻電力特徵NIALM系統架構
本計畫為有效在面對各種配電網路的開發與實際應用，提出對於台灣一般住宅用戶在特殊不平衡單相三線式220V/110V配電網路供電時用電設備使用期間的負載偵測與辨識，如圖3-1所示[3-1]。透過研究方法的實驗與驗證及實務上的操作反應，開發非侵入式電能及需量監測系統的功能，作為日後在智慧電網的佈建功能上提供更多樣化與更可靠的使用選擇。

圖3-1、不平衡單相三線式220V/110V配電網路
圖3-2為本計畫所提出之非侵入式高頻暫態監測系統於電力系統故障分析時的電力特徵萃取流程圖，從非侵入式負載監測系統的電力入口端(Electrical Service Entry, ESE)所量測得到的原始電流信號啟動信號偵測，將偵測到的啟動信號經由本計畫所提特徵萃取演算法萃取出足以辨識的特徵向量，輸入至人工類神經網路辨識系統辨識設備的啟動與關閉。
首先，利用原始電流訊號的時間域電流變化找出負載電流的啟動開始時間(Tstart)，接著透過瞬時電流波形找出暫態發生過程的截止時間(Tstop)，以啟動開始時間到截止時間的區間做為視窗寬度，透過離散小波轉換與Parseval定理分別擷取從啟動開始時間前後視窗寬度的原始電流的暫態訊號，即可得到電力強度。此電力強度即為非侵入式高頻暫態負載監測系統的訓練或測試辨識資料，用來進行負載使用效能評估、負載啟動與關閉類別辨識分析的資料。
為有效減少在日後負載辨識過程所需的資料量與時間，並能提高各項負載在使用效能與負載啟動及關閉分類的辨識率。在負載辨識方面，本計畫提出研究分析與比較僅使用支持向量機(LibSVM)來獲取最佳的負載辨識率，使其能有效地降低所需使用於負載辨識過程中的資料量與計算時間及提高負載的辨識率。
最後，將所辨識出各項負載的使用效能評估及負載啟動及關閉類別分析作計算，計算出負載的使用情形。這些資訊除了可以作為使用設備的資料庫、推導使用設備負載的數學模型與提醒用戶節約能源之外，亦可將這些資料提供政府及電力公司等相關單位，做為日後整體經濟發展上的重要指標，如整體能源開發的指標與未來能源政策制訂的方向、設備耗能指標與節能減碳及大電力設備使用效能等相關政策的制訂與規劃。

圖3-2、非侵入式高頻暫態監測系統電力特徵萃取流程圖
圖3-3所示為使用LabView程式架構一般住宅用戶不平衡單相三線式配電網路的非侵入式負載啟動及關閉監測系統。使用用戶可以利用功能選項將顯示所辨識出各項負載的使用效能、負載分析及其啟動與關閉時間等電力信號，從圖面的各項結果顯示計算出負載的使用情形，顯示負載啟動與關閉的各項指標等。這些資訊可以作為使用設備的辨識資料庫與推導使用設備負載的數學模型。





(a)





(b)
圖3-3、非侵入式高頻暫態啟動及關閉LabView監測系統圖(a)啟動(b)關閉


3.2、小波轉換
針對短時傅立葉轉換(Short-time Fourier Transform, STFT)窗框固定的情況，Jean Morlet 與 A. Grossman 提出小波轉換的概念，並定義之：
	(1)
其中稱之為"子小波"，稱之為"母小波"，a為縮放因子(Scale Factor)，b為平移因子(Shift Factor)。增加了縮放因子a與平移因子b，就是為了改善STFT的固定窗框的概念。
簡單的說，小波轉換是從STFT衍生過來的，一般應用於暫態及非穩態的信號分析與處理，優點如下:
(1)	可以分析處理時頻域信號。
(2)	藉由改變a及b而改變窗框大小。一般窗框的選擇，在分析較高頻信號時，會選擇窗框長度較長；在分析較低頻信號時，會選擇窗框長度較短。
小波轉換具有以下特點：
(1)	小波可基於所在的時間與頻率展現一個信號，是一種時間-頻率表示。
(2)	小波具有多重解析的架構，也具多尺度分析的特點，可用粗調及細調地逐步觀察信號。
(3)	小波分析的主要特點就是能夠解析信號的局部特徵，例如可以發現疊加在一個平滑的正弦信號上一個非常小的畸變信號出現的時間，傳統的傅立葉轉換只能得到頻譜的大小，利用小波分析則可以非常準確地分析出信號在甚麼時候(甚麼時間點)發生畸變。
(4)	如果把小波與傅立葉轉換比較，傅立葉轉換是將信號分解成不同頻率的正弦波，而這些正弦波是沒有時間限制的，即負無限大到無限大；小波轉換則是將信號分解成一系列的小波函數，而這些小波函數大都屬於不規則與不對稱，它們皆是由母波函數經過縮放與平移得到的。用這些不規則與不對稱的小波函數來表示暫態信號，顯然比平滑的正弦曲線還要適當，因此小波比較適合應用於非穩態信號或暫態信號的分析與處理。
離散小波轉換(Discrete Wavelet Transform, DWT)即將連續小波轉換其縮放因子a與平移因子b作離散化，進而得到離散小波轉換。離散小波轉換在數值分析及時頻分析中皆很實用，其目的就是為了可以分析離散的輸入訊號，其觀念就是利用高頻與低頻濾波器，分別將高低頻分離，再加以分析，如圖3-4所示。離散小波轉換其應用於壓縮雜訊、去除雜訊與邊緣偵測。使用低通濾波器()將離散訊號其高頻部分濾掉，保留低頻部分，使用於壓縮、去除雜訊；而使用高通濾波器()將離散訊號其低頻部分濾掉，保留高頻部分，使用於邊緣檢測。
離散小波轉換是將連續小波轉換(CWT)的縮放因子a與平移因子b經過離散化的結果，CWT的數學表示法為：
	(2)
其中是原始訊號(Original Signal); 子小波。
為了獲得DWT，則令
	(3)
將式(3)帶入式(2)，則離散化的小波轉換改為式(4)所示
	(4)
令
	(5)
則式(4)則為
	(6)


圖3-4、離散小波轉換示意圖
其中高低通濾波器之間的關係為
												(7)


3.3、Parseval理論
Parseval定理的推導，從傅立葉級數(Fourier Series)而來。將傅立葉級數左右兩邊各自乘以原始訊號，此物理意義即為求等號右邊訊號之時間域與等號左邊頻率域之能量值。推導過程演譯如下：
傅立葉級數(Fourier Series)如下所示，
	(8)
其中傅立葉係數(Fourier Coefficients)為
	(9)
Parseval定理的證明如下:
將傅立葉級數左右兩邊各自乘以原始訊號，如下所示，
	(10)
左右兩邊積分，
	(11)
其中
	(12)
將式(12)代入式(11)，則
	(13)
所以Parseval定理係為訊號之時間域的能量恆等於其訊號之頻率域的能量。其定義如下所示:
	(14)
如式(14)所示與貝索不等式(Bessel’s Inequalities)比較，可知該式正如貝索不等式的等號成立時的應用案例。
本計畫利用Parseval定理將經由小波轉換後的原始電流訊號轉換成其能量的頻譜圖，其目的在於萃取非侵入式負載監測系統的電力特徵。小波轉換與Parseval定理轉換可以式(15)表示之[3-2]，
	(15)
其中J表示共有J個階層，表示近似值的係數，表示細節值的係數，為時間域係數。
從上式可以得知，右手邊為細節值的頻域率能量分佈，其公式為:
	(16)
其中J表示共有J個階層，為各階層的小波轉換的細節能量值。最後，對式(16)開根號，即可得到各階層細節值的電力強度(Power Intensity)。 
	(17)

3.4、支持向量機
機器學習中的支援向量機是在分類中分析資料的監督式學習模型與相關的學習演算法。給定一組訓練實體，每個訓練實體被標記為屬於兩個類別中的一個或另一個，支援向量機訓練演算法建立一個將新的實體分配給兩個類別之一的模型，使其成為非機率二元線性分類器。支援向量機模型是將實體表示為空間中的點，這樣對映就使得單獨類別的實體被盡可能明顯地間隔分開。然後，將新的實體對映到同一空間，並基於它們落在間隔的哪一側來預測所屬類別。除了進行線性分類之外，支援向量機還可以使用所謂的核技巧有效地進行非線性分類，將其輸入對映到高維度特徵空間中，而非侷限於兩個類別的分析。
SVM 最初作為機器學習演算法開發，用於對兩組或二位元分類問題進行分類[3-3]。多年來，各種研究人員將SVM的範圍擴展到多元分類，並進行了比較，以確定這些方法的有效性[3-4]。基於結構風險最小化，SVM可以避免從局部最小部分找出非線性識別問題，這個問題對倒傳遞神經網路(BP-ANN)[3-5]是一個相當大的問題，支援向量機被使用來辨識負載啟動與關閉去發掘各種不同的負載種類，針對電力入口端所獲得的電力特徵，支援向量機可以避免類似倒傳遞神經網路區域最小化的問題。
為了解決多元SVM問題，SVM網路的變數與目標類型的數量一致。因此，解決了較大的優化問題，或者使用大量二進位制分類器，方法是一對多或一對一方法[3-4]。Lai等人[3-6]使用混合SVM對各種電氣設備的動力屬性進行分類，然後建立了分類模型來確定這些分類電器的分類屬性。Chang [3-5] 利用 SVM 進行特徵擷取，以非侵入式方法辨識低壓配電系統的SLGF故障位置辨識。支援向量機(LIBSVM)是多元分類應用最廣泛的SVM演算法之一。LIBSVM 對多元數據集[3-7]使用一對一方法。它適用於從大問題實驗結果的實際使用[3-4]。Fernandez-Delgado等人[3-8]發現，使用C中SVM的LIBSVM實現高斯內核的svm C是最佳SVM分類器[3-9]，通過自動調整參數，即正規化C和kernel spread gamma，選擇最大化交叉驗證精度的值。

3.5、鳳山實驗屋27個設備啟動電流波形
鳳山實驗屋27個設備基本上區分為傳統與節能變頻的電熱、旋轉電動機(馬達)、壓縮機、(電力)電子等負載，其各個設備啟動的電流波形如下所示。
 
圖3-5、客廳吹風機啟動電流波形圖

 
圖3-6、主臥空氣清淨機啟動電流波形圖

 
圖3-7、主臥除溼機2啟動電流波形圖

 
圖3-8、客廳智慧電視啟動電流波形圖

 
圖3-9、客廳電風扇2啟動電流波形圖

 
圖3-10、主臥電風扇3啟動電流波形圖

 
圖3-11、客廳55吋液晶顯示器與視訊盒啟動電流波形圖

 
圖3-12、廚房冰箱啟動電流波形圖

 
圖3-13、客廳空調1啟動電流波形圖

 
圖3-14、主臥空調2啟動電流波形圖

 
圖3-15、次臥空調3啟動電流波形圖

 
圖3-16、後陽台洗衣機啟動電流波形圖

  
圖3-17、客廳乾衣機啟動電流波形圖

    
圖3-18、客廳智慧照明1啟動電流波形圖

    
圖3-19、餐廳智慧照明2啟動電流波形圖

  
圖3-20、主臥智慧照明3啟動電流波形圖

  
圖3-21、主臥智慧照明4啟動電流波形圖

  
圖3-22、次臥智慧照明5啟動電流波形圖

     
圖3-23、前陽台照明1啟動電流波形圖

    
圖3-24、廚房照明2啟動電流波形圖

    
圖3-25、後陽台照明3啟動電流波形圖

    
圖3-26、走道照明4啟動電流波形圖

    
圖3-27、廁所照明5啟動電流波形圖

    
圖3-28、浴室照明6啟動電流波形圖
  
圖3-29、廚房電飯鍋啟動電流波形圖

  
圖3-30、廚房電磁爐啟動電流波形圖

  
圖3-31、後陽台電熱水器啟動電流波形圖



3.6、鳳山實驗屋13個設備關閉電流波形
鳳山實驗屋其各個設備關閉的電流波形如下所示。
 
圖3-32、客廳吹風機關閉電流波形圖

  
圖3-33、主臥空氣清淨機關閉電流波形圖

 
圖3-34、主臥除溼機2關閉電流波形圖

 
圖3-35、客廳智慧電視關閉電流波形圖

 
圖3-36、客廳電風扇2關閉電流波形圖

 
圖3-37、客廳55吋液晶顯示器與視訊盒關閉電流波形圖

 
圖3-38、廚房冰箱關閉電流波形圖

 
圖3-39、客廳空調1關閉電流波形圖

 
圖3-40、後陽台洗衣機關閉電流波形圖
  
圖3-41、客廳乾衣機關閉電流波形圖

 
圖3-42、廚房電飯鍋關閉電流波形圖

 
圖3-43、廚房電磁爐關閉電流波形圖
 
圖3-44、後陽台電熱水器關閉電流波形圖




3.7、實作量測負載辨識率
鳳山實驗屋實作測量負載辨識率的場景依據操作不同，可以區分以下三種：
場景一，單一負載啟動(Single load turn-on)，操作模式：任意時間其他負載停止運轉，單一負載啟動。
場景二，多負載運轉 (Multiple loads operation)，操作模式：在暫態特徵下，固定負載數量n中，(n-1)負載混合運轉，另一負載(the nth)啟動。在穩態特徵下，固定負載數量n中，排列組合負載混合啟動(運轉)。
場景三，設定主要負載啟動辨識 (Primary loads turn-on)，操作模式：在暫態特徵下，設定主要負載數量與次要負載。主要負載數量n中，(n-1)負載與次要負載混合運轉，另一主要負載(the nth)啟動，只針對主要負載做啟動辨識。在穩態特徵下，設定主要負載數量與次要負載。主要負載數量n中，排列組合主要及次要負載混合啟動(運轉)，只針對主要負載做啟動(運轉)辨識。



3.7.1、實作量測負載啟動辨識率(取樣頻率10kHz)
場景一























場景二
















場景三












































3.7.2、實作量測負載關閉辨識率(取樣頻率10kHz)
場景三












































3.7.3、實作量測重新10種負載組合啟動辨識率(取樣頻率10kHz)
場景三



























3.7.4實作量測重新10種負載組合關閉辨識率(取樣頻率10KHz)
場景三
























3.7.5實作量測負載組合啟動/關閉辨識率(取樣頻率5kHz)
場景三












3.8、高頻暫態特徵實驗結論
本計畫使用虛擬儀測工程平台軟體(LabView Program)建立非侵入式高頻暫態量測負載啟動與關閉，搭配資料擷取卡(DAQ)，實現實際的非侵入式高頻暫態負載啟動與關閉的監測與負載辨識平台，實際量測鳳山實驗屋不平衡單相三線式220V/110V 配電網路住宅用戶用電設備的電氣信號，同時研究改善不平衡單相三線式配電網路電力特徵的解偶合能力，增加負載在非侵入式架構中負載使用效能與分析的能力，建構一個具有完整的非侵入式電能及需量監測與負載分析功能，進而尋求技術的改善，克服非侵入式負載辨識所面臨的各種問題。過程中，進行軟體程式設計與實際數值案例的成效測試。歸納本計畫所提出之貢獻及對於非侵入式監測系統應用在未來智慧電表，最佳負載辨識率為基礎所做的研究方面，分別以各種不同的設備案例的架構進行軟體程式與實際案例作測試與比較，所提出之相關研究的具體成果與預期的貢獻如下：
(1) 於高雄鳳山實驗屋辨識10種家庭一般常使用的電器如冰箱、客廳空調、除濕機、洗衣機、電飯鍋、電熱水器、液晶顯示器與視訊盒、電磁爐、吹風機、乾衣機等，其整體負載辨識率可以達到90.6667%，對於其中6種家庭電器其負載辨識率甚至可以達到95.5556%，對比於使用高頻穩態特徵如實功率、需功率及電流總諧波失真率的平均80%高出許多。


3.8.1 實作量測負載組合啟動/關閉辨識率(取樣頻率10kHz)
場景三
負載數2: 冰箱及客廳空調1;
負載數6: 冰箱、客廳空調1、除濕機2、洗衣機、電飯鍋、電熱水器;
負載數10: 冰箱、客廳空調1、除濕機2、洗衣機、電飯鍋、電熱水器、液晶顯示器與視訊盒、電磁爐、吹風機、乾衣機。
(2) 選擇符合用戶實際需求或適當的家庭電器種類可以明顯改善整體辨識率，例如此次10種家電種類由原先的冰箱、客廳空調1、除濕機2、洗衣機、電飯鍋、電熱水器、液晶顯示器與視訊盒、空氣清淨機、智慧電視、電磁爐更改為冰箱、客廳空調1、除濕機2、洗衣機、電飯鍋、電熱水器、液晶顯示器與視訊盒、電磁爐、吹風機、乾衣機，其中將不易辨識的空氣清淨機及智慧電視更換為吹風機及乾衣機，其整體辨識率可以由85.6667%提升至90.6667%。
(3)此次實驗考量未來結合傳感器內部記憶體容量因素，在未增加改善高頻濾波技術的前提下，改以信號取樣頻率5kHz對相同10種家庭負載做辨識，其所得整體辨識率可以達到87.0%，對於其中6種家庭電器其負載辨識率為89.4444%，明顯得到整體辨識率有下降趨勢。此一結果可以對於未來結合傳感器硬體實作時提供參考。在改善更高的整體辨識率下，使用高於10kHz的信號取樣頻率，同時輔以高頻濾波的改善技術藉以濾除不必要的雜訊及電磁干擾。
(4) 為了克服傳統非侵入式負載監測系統的缺點，本計畫提出使用LabView及Matlab演算法結合支持向量機來提高對於不平衡單相三線式配電網路負載的辨識精確度與減少包含記憶體及計算時間等的計算需求。
(5) 該方法的應用無關乎負載的操作模式及所處操作於不同電壓大小的電壓源，其亦可應用於其他負載；同時可以克服非侵入式負載辨識所面臨的各種問題。
(6) 將所辨識出使用的各項負載在其啟動與關閉作辨識，計算出負載的使用情形，作為提醒使用用戶節約能源及減少不必要的能源消耗。這些資訊除了可以作為一般家庭、商業大樓內部與工業等使用設備的資料庫、推導使用設備負載的數學模型與提醒用戶節約能源之外，亦可做為日後設備耗能指標、節能減碳、設備使用效能評估等相關政策制訂與規劃。






3.8.2 期末審查意見補充說明
問題：對於暫態辨識率從辨識率提升(26負載)至辨識率下降(610負載)請加強說明原由。
期末報告書第三章結論第(2)選擇符合用戶實際需求或適當的家庭電器種類可以明顯改善整體辨識率，負載數2為冰箱及客廳空調1;負載數6為冰箱、客廳空調1、除濕機2、洗衣機、電飯鍋、電熱水器;負載數10為冰箱、客廳空調1、除濕機2、洗衣機、電飯鍋、電熱水器、液晶顯示器與視訊盒、電磁爐、吹風機、乾衣機。
從第3.7.1、實作量測負載啟動辨識率(取樣頻率10kHz)及3.7.3、實作量測重新10種負載組合啟動辨識率(取樣頻率10kHz)場景三中明顯負載數6新增除濕機2、洗衣機、電飯鍋、電熱水器改善只有負載數2為冰箱及客廳空調1的辨識率，但於負載數10新增的液晶顯示器與視訊盒、電磁爐、吹風機、乾衣機中電磁爐、吹風機、乾衣機拉低了整體負載啟動辨識率。



從第3.7.2、實作量測負載關閉辨識率(取樣頻率10kHz)及3.7.4實作量測重新10種負載組合關閉辨識率(取樣頻率10KHz)場景三中負載數6新增除濕機2、洗衣機、電飯鍋、電熱水器雖並無顯著改善只有負載數2為冰箱及客廳空調1的辨識率亦未有拉低辨識率，但於負載數10新增的液晶顯示器與視訊盒、電磁爐、吹風機、乾衣機中液晶顯示器與視訊盒、電磁爐、乾衣機拉低了整體負載啟動辨識率。



所以從此結論對於整體辨識率而言如期末報告書初稿第三章結論第(2)選擇符合用戶實際需求或適當的家庭電器種類可以明顯改善整體辨識率，反之選擇不符合用戶實際需求或不適當的家庭電器種類亦有可能拉低整體辨識率。

第四章、低頻電力特徵之NIALM遷移學習技術開發
目前NIALM技術受限於需要事先建立各自用戶之用電解析模型、家電標籤與訓練，才能精準解析其細部家電用電，但在實際商業應用會有其障礙。因此仿照影像辨識之技術發展經驗，透過遷移式學習(Transfer Learning)技術，利用已建立好之NIALM用電解析模型來解析非模型訓練用戶之用電，並實際導入100戶HEMS智慧家庭之示範場域，以利後續擴大NIALM技術之商業應用。
4.1、遷移學習技術之定義及分類
遷移學習是機器學習中解決培訓數據不足這一基本問題的重要工具。試圖通過放寬訓練數據和測試數據必須是獨立同分布的假設，將知識從源領域轉移到目標領域。這將對許多由於訓練數據不足而難以改進的領域產生巨大的正向影響。遷移學習的學習過程[4-1]如圖4-1所示：

圖4-1、遷移學習的學習過程
需要明確定義使用的一些符號。首先，分別給予一個域和一個任務之定義：一個域可以用D = {χ，P(X)}表示，它包含兩部分：特徵空間χ和邊緣概率分佈P(X)，其中X = {x1，...，xn}∈χ。任務可以用T = {y，f(x)}表示。它由兩部分組成：標籤空間y和目標預測函數f(x)。f(x)也可以視為條件概率函數P(y | x)。接著，可以將轉遷移學習正式定義如下：
(1)	遷移式學習：
基於Dt的學習任務Tt，可以從Ds獲得有關學習任務Ts之幫助。遷移學習目的在於透過以下方式提高學習任務Tt的預測函數f(T)之性能：發現和繼承來自Ds和Ts之潛在知識，其中Ds不等於Dt或Ts不等於Tt。另外，在大多數情況下，Ds的大小比Dt的大小多了許多，即Ds>>Dt。
根據來源域和目標域之間的關係將轉移學習方法分為三大類。這些內容總結了過去有關遷移學習之文獻，其中介紹許多經典之遷移學習方法。此外，最近提出了許多更新更好的方法。近年來，遷移學習研究主要專注在這兩個方面：領域適應和多源領域遷移。
近年來，深度學習已在許多研究領域中佔據主導地位。重要的是找到如何透過深度神經網路有效地繼承知識，這稱為深度轉移學習，其定義如下：
(2)	深度遷移學習：
給定由Ds、Ts、Dt、Tt以及f(T)定義之轉移學習任務。f(T)是反應深層神經網路之非線性函數，是一項深度遷移學習任務。
深度遷移學習可進一步再分為四類[20]：(A)基於實例的深度遷移學習、(B)基於映射的深度遷移學習、(C)基於網路的深度遷移學習、和(D)基於對抗的深度遷移學習。
(A)基於實例的深度遷移學習
基於實例的深度遷移學習是指使用特定的權重調整策略，通過為這些選定實例分配適當的權重值，從來源域中選擇部分實例作為對目標域中訓練集的補充。它基於以下假設：＂儘管兩個域之間存在差異，但目標域可以適當的權重利用來源域中的部分實例＂。基於實例的深度遷移學習如圖4-2[20]所示。

圖4-2、基於實例的深度遷移學習
訓練數據集中排除了來源域中含義與目標域不同的淺藍色實例；來源域中具有深藍色的實例與目標域具有相似的含義，並且包含在具有適當權重的訓練數據集中。
Dai提出之TrAdaBoost使用基於AdaBoost的技術來篩選出與來源域中的目標域不同的實例。在來源域中對實例進行加權，以組成類似於目標域的分佈。最後，通過使用來自來源域的重新加權實例和來自目標域的原始實例來訓練模型。它可以減少保留AdaBoost屬性的不同分佈域上的加權訓練誤差。Yao提出之TaskTrAdaBoost是一種快速算法，可促進對新目標進行快速再訓練。不同於TrAdaBoost是為分類問題設計的；Pardoe提出了ExpBoost.R2和TrAdaBoost.R2來解決回歸問題；Wan提出之雙加權域自適應(BIW)可以將兩個域的特徵空間對準公共坐標系，然後從來源域中分配適當的實例權重；Li提出了一種增強之TrAdaBoost，以處理區域間砂岩顯微圖像分類的問題；Xu提出了一種度量轉移學習框架，以在並行框架中學習實例權重和兩個不同域的距離，以使跨域的知識轉移更加有效；Liu將集成轉移學習引入到可以利用來源域實例的深度神經網路。
(B)映射式的深度遷移學習
基於映射的深度傳輸學習是指將實例從來源域和目標域映射到新的數據空間。在這個新的數據空間中，來自兩個域的實例類似，並且適用於聯合深度神經網路，參考圖4-3所示。它基於以下假設：「儘管兩個原始域之間存在差異，但在精心設計的新數據空間中它們可能會更相似」。

圖4-3、顯示基於實例的深度遷移學習的示意圖
同時，來自來源域和目標域的實例也更相似地映射到新的數據空間。將新數據空間中的所有實例視為神經網路的訓練集。
Pan和基於TCA的方法將Zhang引入之轉移成分分析(TCA)已被廣泛用於傳統轉移學習的許多應用中。一個自然之想法是將TCA方法擴展到深度神經網路。Tzeng通過引入適應層和額外的域混淆損失來學習一種在語義上有意義且領域不變的表示形式，從而將MMD擴展為比較深層神經網路中的分佈。MMD距離定義為：
					(3.1)
而損失函數被定義為：
							(3.2)
Long透過用Gretton提出之多核變體MMD(MK-MMD)距離替換MMD距離，改進了以前的工作。卷積神經網路(CNN)中與學習任務相關之隱藏層被映射到再生核希爾伯特空間(RKHS)中，並且通過多核優化方法將不同域之間的距離最小化；Long提出聯合最大平均差異(JMMD)來測量聯合分佈的關係。JMMD用於概括深度神經網路(DNN)的傳遞學習能力，以適應不同領域中的數據分佈並改進以前的工作。由Arjovsky提出之Wasserstein距離可以用作域的新距離測量以找到更好之映射。
(C)網路式之深度遷移學習
基於網路之深度遷移學習是指對來來源域中經過預先訓練之局部網路(包括其網路結構和連接參數)進行重新運用，將其轉變為目標域中使用之深度神經網路的一部分。它基於以下假設：＂神經網路類似於人腦的處理機制，並且是一個迭代且連續的抽象過程。網路之前層可以被當作特徵提取器，提取的特徵是通用的＂。基於網路之深度遷移學習的示意如圖4-4所示：

圖4-4、基於網路之深度遷移學習
使用大規模訓練數據集在來源域中對網路進行了訓練。其次，將針對來源域進行預訓練的部分網路轉移為針對目標域設計的新網路的一部分。最後，可以以微調策略來更新所傳送的子網。
Huang將網路分為兩部分，前一部分是與語言無關的特徵轉換，最後一層是相對於語言的分類器。與語言無關的特徵變換可以在多種語言之間傳遞。Oquab重用CNN在ImageNet數據集上訓練的前層，以計算其他數據集中的圖像的中間圖像表示，訓練CNN以學習圖像表示，這些圖像表示可以有效地轉移到數量有限的訓練數據的其他視覺識別任務中。Long提出了一種從來源域中的標記數據和目標域中的未標記數據聯合學習自適應分類器和可傳遞特徵的方法，該方法通過將幾層插入到深度網路中來明確地學習目標分類器的殘差函數。Zhu在DNN中同時學習域自適應和深度哈希功能。Chang提出了一種新穎的多尺度卷積稀疏編碼方法。該方法可以以聯合方式自動地以不同的規模學習濾波器組，並具有所學習模式的增強規模專用性，並為學習可轉移的基礎知識並將其針對目標任務進行微調提供了一種無監督的解決方案。
George應用深度轉移學習將知識從現實世界的對象識別任務轉移到故障分類器，以用於多個重力波信號的檢測器。它證明了DNN可以用作無監督聚類方法的優秀特徵提取器，從而基於它們的形態來識別新類，而無需任何標記示例。
另一個非常值得注意的結果是Yosinski指出了網路結構和可傳輸性之間的關係。結果表明，某些模塊可能不會影響域內準確性，但會影響可傳遞性。它指出了在深層網路中哪些功能可以轉移，以及哪種類型的網路更適合轉移。得出的結論是LeNet、AlexNet、VGG、Inception以及ResNet是基於網路之深度傳輸學習的不錯選擇。
(D)對抗式的深度遷移學習
基於對抗之深度轉移學習是指引入對抗性技術，該技術受生成對抗性網路(GAN)的啟發，以找到適用於來源域和目標域之可繼承展示。它基於這樣的假設：”對於有效之遷移，良好的展示應於主要學習任務有區別性，並且在來源域和目標域之間無區別性”。基於對抗之深度遷移學習如圖4-5所示：

圖4-5、基於對抗的深度遷移學習
在來源域的大規模數據集訓練過程中，網路的前層被視為特徵提取器。它從兩個域中提取特徵，並將其發送到對抗層。對抗層嘗試區分要素的來源。如果對抗網路的性能較差，則意味著這兩種功能之間的差異很小，並且可傳遞性更好，反之亦然。在下面的訓練過程中，將考慮對抗層之性能，以迫使遷移網路發現具有更高可遷移性的一般特徵。
基於對抗的深度遷移學習由於其良好的效果和較強的實用性，近年來獲得了長足的發展。Ajakan引入對抗技術，通過在損失函數中使用域適應正則項來遷移學習以進行域適應；Ganin提出了一種對抗訓練方法，該方法通過增加很少的標準層和簡單的新的梯度反轉層而適用於大多數任何前饋神經模型；Tzeng提出一種方法，用於稀疏標記的目標域數據的知識跨域和跨任務同時性。在這項工作中使用了特殊的聯合損失函數來強制CNN來優化定義為LD = Lc +λLadver的兩個域之間的距離，其中Lc是分類損失，Ladver是域對抗損失。由於這兩個損耗彼此直接相對，因此引入了一種迭代優化算法來在固定另一個損耗時更新一個損耗；Tzeng提出了一種新的GAN丟失方法，並與判別建模相結合，從而提出了一種新的域自適應方法；Long提出了一種基於隨機多線性對手的多特徵隨機層和分類器層的隨機多線性對抗網路；Luo利用領域對抗性損失，並使用基於度量學習之方法將嵌入推廣到新穎任務中，以在深度轉移學習中找到更易處理的特徵。
在大多數實際應用中，通常將上述多種技術結合使用以獲得更好的效果。當前大多數研究集中在監督式學習上，如何通過轉移知識到無監督或半監督學習的深度神經網路在未來引起越來越多的關注。負遷移和可遷移性測量是傳統遷移學習中的重要問題。這兩個問題的影響在深度遷移學習還需要進行進一步的研究。

4.2、遷移學習技術執行方法
以從前期計畫之訓練結果來看，30戶示範住戶之家電識別準確度在定性的部分(F-score)平均值約70%左右；接著根據不同家庭住宅特性篩選出住戶，並利用遷移式學習(Transfer Learning)之演算手法做家庭電器預測，其架構如圖4-6所示。

圖4-6、遷移式學習之預測架構
首先將AMI原始資料作前處理，其中包含用電資料格式轉置、離群值或異常值檢測(VEE技術)以及分群分類等；再將資料parsing成model可讀取之資料型態。另一方面，透過示範住戶之多迴路電表、插座電表所量測之各個家庭電器特徵，如電壓、電流、實功、虛功以及用電量(kWh)，建立特徵data(即csv檔)，利用CNN卷積神經網路之Sequence-to-point演算法訓練建立其各個家電之模型(即電器指紋模型)，作為整個遷移學習之輸入(Input)，接著本研究參考上述相關國際文獻之遷移式學習技術中的網路式之深度遷移學習方法，導入電器種類數量等參數，完成整個遷移式學習系統架構。
本研究參考國際文獻的手法，使用CTL(Cross-domain Transfer Learning)跨源域遷移式學習技術，首先定義域(Domain)，域表示數據是從同一國家或同地區收集的資料，本研究為住宅用電資料、住宅特性、設備使用時間。CNN模型會先在大型數據集進行訓練(Training)，而CTL遷移學習方法則是將訓練好的模型直接應用於不同領域的測試數據。圖4-7為國際文獻[4-2]利用兩個公開資料集，分別為UK-DALE、REFIT實作跨源域遷移式學習技術，CNN訓練模型演算法為Sequence-to-point；參考基線演算法為AFHMM，由於UK-DALE與REFIT兩個域之住宅特性差異小，可直接遷移學習。

圖4-7、UK-DALE以及REFIT跨源域遷移式學習評估結果
除此之外，該文獻利用另外兩個公開資料集作實驗分析，分別為REDD以及REFIT，CNN訓練模型演算法同樣為Sequence-to-point；參考基線演算法同樣為AFHMM，評估結果如圖4-8所示。


圖4-8、REDD以及REFIT跨源域遷移式學習評估結果
由圖中可以看出，其MAE值差異較大，表示跨源域遷移式學習結果較差，其原因為REDD與REFIT兩個域之住宅特性差異大，無法直接遷移學習。該篇國際文獻研究之解決方法為CNN的卷積層不變，全連接層重新訓練(dense layers)，即可改善準確度。綜合上述分析，本研究歸納一些論點如下：
在所有學術文獻上，跨源域遷移式學習之技術皆應用於公開資料集的資料，以利後續作準確度評估以及驗證
源域與目標域之用電資料全部皆為已知(插座電表)之資訊，透過插座電表獲得各個設備用電資料，收集其真實用電數據
學術上遷移式學習並非完全不再訓練模型，而是透過新資料(目標域)精進原模型(局部訓練)
本研究參考該研究技術，源域為已訓練好之示範住戶電器模型(利用插座電表)；目標域為其他示範住戶之總用電資料(沒有插座電表)
因此，未來若要執行商業運轉需額外條件(問卷)輔佐並驗證，額外條件包含1.電器種類2.電器使用時間(問卷)。此部分為與學術研究論文最大之差異。
目前在問卷調查的部分，已針對某一區域(村里)之具有AMI智慧電表家庭住宅作相關問卷調查，主要內容包含電器種類以及電器使用時間；調訪住宅數為203戶，參考表4-1所示，為電器種類之數量分布。
表4-1、問卷調查分析電器種類數量

可以看出，家庭住宅主要具備之設備為冷氣機、電視、電鍋、抽油煙機、吹風機、冰箱、洗衣機與電風扇。圖4-9~圖4-13為各個主要電器設備問卷調查之使用時間分布。

圖4-9、問卷調查電視使用時間分布


圖4-10、問卷調查電鍋使用時間分布


圖4-11、問卷調查洗衣機使用時間分布


圖4-12、問卷調查電腦使用時間分布


圖4-13、問卷調查吹風機使用時間分布
由上述之問卷統計結果，可以建立背景資料庫，利於遷移式學習演算法之驗證參考依據；同時也可以精進其總用電解析的準確度，若未來分析其他住宅之設備用電行為習慣與問卷之結果差異較大時，亦可透過鳳山實驗屋創造新的電器使用時間分布，新增至背景資料庫中，作更佳化的用電解析。根據前期計畫所建置的所有示範住戶電器設備指紋模型，作統整與歸納整理，示範住戶共30戶；共計30種電器設備約187個模型，如表4-2所示，主要模型為冷氣機、照明、電冰箱、熱水瓶、電鍋、電視機、洗衣機、機上盒以及電風扇。
表4-2、已建置的電器設備指紋模型分布


其中，每一個電器指紋模型皆由插座電表或是多迴路電表與總電表的每一分鐘一筆用電量(kWh)透過CNN深度學習演算法所訓練出來的模型，參考示意如圖4-14~圖4-19所示，其中X軸為時間單位；Y軸為耗電量(Wh或kWh)；藍色負載曲線為設備之耗電，橘色負載曲線為總耗電。


圖4-14、某示範住戶電鍋指紋模型示意


圖4-15、某示範住戶洗衣機指紋模型示意


圖4-16、某示範住戶電視指紋模型示意


圖4-17、某示範住戶冷氣指紋模型示意


圖4-18、某示範住戶電風扇指紋模型示意


圖4-19、某示範住戶照明指紋模型示意


4.3、遷移學習之模型讀取(Load Model)
本研究計畫遷移學習技術中的模型讀取(Load Model)架構如圖4-20所示，下方為目前背景資料庫中所有示範住戶現有的共計30種電器設備約187個模型，示意成電器A、電器B以及電器C等具有Model_1~Model_N；上方為目標域的示範住戶之總用電資料、欲解析電器設備以及電器設備使用時間，而中間則為將這兩者全部彙整合進來之程式。


圖4-20、遷移學習的Load Model架構


以其中一戶為示範，參考圖4-21所示，該戶的欲解析總用電日期為7月31日；欲解析電器為冷氣、電鍋、機上盒以及冰箱。根據問卷調查結果，可得知該戶冷氣使用時間為下午與晚上；電鍋使用時間為下午。盤點所有目前現有的設備模型中，冷氣共28個；電鍋共13個；機上盒共11個以及冰箱共21個，若以排列組合之方法解析該住宅(目標域)的總用電成這四種電器設備，其計算成本與計算複雜度極高，而本研究遷移學習演算法核心技術在於從這些模型中找到最適合解析目標域住宅用戶總用電的模型。


圖4-21、某示範住戶的Load Model架構
首先，由於該示範住戶有安裝插座電表與迴路電表，因此可以以該住戶所訓練好的電器模型之解析準確度作為基線。圖4-22與圖4-23分別為該戶某日之總用電與空調實際用電之負載曲線(藍色曲線為總用電；橘色曲線為空調實際用電)和總用電與空調用電解析預測之負載曲線(綠色曲線)，其利用F-Score定性準確度評估指標約70%左右。


圖4-22、總用電與空調實際用電之負載曲線


圖4-23、總用電與空調用電解析預測之負載曲線


圖4-24~圖4-27分別在現有的所有空調模型中，任意選出四個空調模型遷移學習到該示範住戶上，作空調用電解析，並根據迴路電表所量測到空調的實際用電量，計算定性F-Score的準確度。


圖4-24、利用空調模型A遷移學習解析該示範住戶空調用電


圖4-25、利用空調模型B遷移學習解析該示範住戶空調用電


圖4-26、利用空調模型C遷移學習解析該示範住戶空調用電


圖4-27、利用空調模型D遷移學習解析該示範住戶空調用電
藉由上述分析，利用空調模型A遷移學習解析該示範住戶空調用電，其定性F-Score的準確度為0.49；利用空調模型B遷移學習解析該示範住戶空調用電，其定性F-Score的準確度為0.60；利用空調模型C遷移學習解析該示範住戶空調用電，其定性F-Score的準確度為0.83；利用空調模型D遷移學習解析該示範住戶空調用電，其定性F-Score的準確度為0.95。
因此，可以觀察出模型A跟模型B對於該戶該日之空調用電解析效果不好，而模型C跟模型D適合該戶該日之空調用電解析，甚至高於該戶利用自身空調模型，其原因為該日之總用電迴歸到空調用電與模型C跟模型D極為相似，但此現象並不代表每一天之準確度皆有此成效。因此，需計算整體的定性F-Score平均值，並且開發一符合所有天的耗電情況的用電解析演算法，其方法如下節說明。



4.4、CTL Load Disaggregation負載用電解析
隨著背景資料庫之電器設備指紋模型不斷的擴充，在未來商業運轉模式下，家庭住宅總用電解析不再安裝插座電表及多迴路電表作設備用電資料量測、收集與訓練，以節省硬體設備的成本與入戶安裝設備的人力成本。藉由遷移式學習用電負載解析演算法，選擇使用現有的模型作解析為商業運轉主要方法之一，而在眾多模型下，選擇適合的模型分為以下幾項作法：
1.	Time window segment adjustment：
所謂Time window segment即是將每日24小時切割成幾個片段，每一個片段之總用電負載皆為獨立的資料，個別作設備模型遷移學習。此目的在於遷移模型時，可以有較大的彈性空間，不需一天只用一種模型去解析總電力，而是一日24時可以根據不同時間區段尋找不同但適合的設備模型作電力解析，此方法之優點為可以提升準確度，但若segment切割數量過多，則時間成本與運算複雜度會大幅增加。圖4-28為將一日24時切割成4個時間區間，每個時間區間為6小時，以紅色方框表示。

圖4-28、將一日24時切割成4個時間區間示意
2.	Appliance ON/OFF threshold：
本研究針對所有設備之電力解析，輸入值(Input)為總用電，單位為kWh，而輸出值(Output)亦為一量值，單位為kWh，需要定義一閥值(Threshold)，來判斷該量值之設備狀態是否為開啟(ON)的狀態，參考圖4-29所示，而每個設備的閥值(Threshold)設定皆不同，會根據該戶提供之基本資料定義，而在目前實驗研究分析中，利用既有示範住戶所訓練好的模型內設備所定義之閥值。此部分的參數調整設定，將影響計算定性F-Score的準確度高低。

圖4-29、判斷該量值之空調狀態是否為開啟狀態示意

3.	Load regression algorithm：
從上述切割一時間區間(segment)作遷移學習，並尋找出最適當之模型，架構示意如圖4-30。本研究參考國際文獻[4-3]的部分手法，利用Pearson Product Moment Correlation Coefficient Algorithm演算法計算最大之r值，作為遷移學習模型的對象。

圖4-30、切割一segment作遷移學習，尋找最適當模型架構示意
皮爾森積動差相關係數(Pearson product-moment correlation coefficient，又稱作PPMCC或PCCs)用於度量兩個變數X和Y之間的相關程度(線性相依)，其值介於-1與1之間。在自然科學領域中，該係數廣泛用於度量兩個變數之間的線性相依程度。它是由卡爾·皮爾森從弗朗西斯·高爾頓在19世紀80年代提出的一個相似卻又稍有不同的想法演變而來，這個相關係數也稱作「皮爾森相關係數r」，其公式如下所示：

若Xi 越大，Yi 越大(或Xi 越小，Yi 越小)，r > 0稱為正相關；反之，若 Xi 越大，Yi 越小(或Xi 越小，Yi 越大)，r < 0稱為負相關。透過數據的分布，能知道X和Y是否為高度相關，要是數據分布越趨近於一條線，就越高度相關，相關係數數值越趨近於 1 or -1。本研究X為test data的總用電量(kWh)；Y為model data的總用電量(kWh)，個別計算區域segment之不同模型r值，參考示意如圖4-31：

圖4-31、計算區域segment之不同模型r值
根據統計學之觀點，r值一般可按三級劃分：|r|<0.4為低度線性相關；0.4≤|r|<0.7為顯著性相關；0.7≤|r|<1為高度線性相關，本研究定義r值的門檻篩選閥值為0.4~0.5，若大於0.5則採用該模型作為遷移學習之模型，因此，上述之最佳遷移學習模型為Home-C的空調模型(計算其r值為0.54)。
本研究定義住宅之總用電負載目標解析出五種家電設備，分別為冷氣機、照明、電鍋、電視機以及洗衣機，其原因為：
1. 目前現有示範住戶之主要電器指紋模型多半分布於這些家電；
2. 根據問卷調查統計顯示結果，其一般家庭住宅最常見之電器設備為上述五種電器設備，參考下表4-3所示。
表4-3、設備模型與問卷調查分析最主要電器種類


以某一示範住戶為例，將一日總用電時間區間切割成四個segments，每一個segment皆為六小時，個別計算五種電器之r值，並搜尋出最大r值相對應之電器指紋模型，H01表示示範住戶編號1號的電器模型，以此類推。實驗研究結果如表4-4與表4-5所示：
表4-4、計算並找出五種電器不同時間區間的最大r值


表4-5、搜尋出最大r值相對應之電器指紋模型


從上述實驗結果觀察，紅色粗體字為總用電關聯性較大之r值，並找出可遷移學習之相對應電器模型作解析。其中，空調以及電鍋因為示範住戶HomeA家中裝有插座電表與多迴路電表作量測與訓練，在計算r值時可直接找到關聯性r最大的那一天並且套用該天之訓練模型作用電解析。然而，有些時段如Seg1找不出總用電關聯性較大之r值(即所有現有模型中無總用電關聯性與該戶該天的總用電相似)，因此，本研究的解決方法為可以利用鳳山實驗屋創造新的用電負載與模型，作為擴充背景資料庫中模型的作法。



4.5、準確度評估指標
本研究測試實驗主要利用F-Score指標來評估電能拆解演算法效能，因F-Score為Precision與Recall綜合評估指標，可綜合了解電器ON/OFF狀態分類效能。
定性指標F-Score，用於評估電器ON/OFF狀態分類是否正確，該數值介於0到1之間越大表是效能越佳，其數學描述如下：




TP(True Positive)：電器n正確預測開啟次數
FP(False Positive)：電器n預測關閉但實際為開啟狀態次數
FN(False Negative)：電器n預測開啟但實際為關閉狀態次數
TN(True Negative)：電器n正確預測關閉次數

如下表4-6，在機器學習領域和統計分類問題，混淆矩陣(Confusion matrix)[4-4]是以可視化表格說明TP, FP, FN, TN，特別用於監督學習，在非監督學習則稱為匹配矩陣。矩陣的每一列代表一個類的實例預測，而每一行表示一個實際類別。
表4-6、混淆矩陣(Confusion matrix)

遷移學習演算法若要驗證其實驗結果的準確度與可行性，需要滿足以下兩個條件之一：
目標域之住宅需安裝插座電表及多迴路電表量測上述五種主要電器的電力，作為實際值的驗證依據。
目標域之住宅需填寫五種主要電器的使用時間，作為實際使用時間的驗證依據。
下表4-7為前期NIALM示範住戶，因其家中裝有插座電表與多迴路電表量測空調與電鍋的電力資訊，因此可以計算F-Score的結果，而照明、電視與洗衣機則需另外量測實際電力資訊或是透過問卷的方式來作遷移學習演算法之驗證。
表4-7、插座與迴路電表量測空調與電鍋耗電，計算F-Score結果


遷移式學習演算法確實可以將訓練好的模型直接應用於不同領域的測試數據，其優點在於減少計算複雜度與計算成本，除此之外，利用Time Segment技術可以達到與需要訓練模型之CNN演算法準確度接近。根據國際參考文獻，遷移式學習演算法可應用於解析同類型不同設備之用電(Ex：電鍋模型解析烤箱或微波爐；電視模型解析電腦等，功率相似且使用時間相同)。然而，Time Segment之設計不宜過小(增加計算複雜度與計算成本)；r值越大，並不一定代表設備解析準確度越高，仍需作驗證並修正(插座電表、問卷調查)。
住宅的基本問卷調查如人口數、屋齡、坪數、電器種類與使用時間等等，可幫助NILM遷移式學習演算法的驗證與精進，因為透過問卷的資訊可以建立基本的人的用電負載曲線，透過分析後亦可以儲存入後台背景資料庫中，作為另一種形式的電器使用行為模式模型。
下圖4-32為某示範住戶A根據問卷調查分析家內主要電器設備的使用時間區間，以兩個小時為一個時間區間單位，若該區間有使用電器，則填寫為1；若無使用，則填寫為0。

圖4-32、示範住戶A問卷調查分析家內電器設備的使用時間



4.6、CTL遷移式學習精進
除了利用皮爾森積動差相關係數演算法計算目標域與來源域之總用電量的關聯性以外，住宅的基本問卷調查如人口數、屋齡、坪數、電器種類與使用時間等等，可幫助NILM之遷移式學習演算法的驗證與精進。參考2019年國際文獻「Nonintrusive load monitoring in residential households with low-resolution data」[4-5]，考慮近似住宅參數，分別為屋齡、坪數、樓層、設備數量、相同種類設備數量以及平均負載，如表4-8的X1~X6所示：
表4-8、國際文獻考慮近似住宅參數

資料來源：[4-5]
其中，該文獻表示，近似住宅參數的重要程度為X6>X5>X2，即平均負載>相同種類設備數量>坪數，因此，本分項研究參考該文獻作為依據，並且分別計算這些參數，參數計算公式如下所示(以坪數X2為例)：



其中，𝑆𝑓𝑀與𝑆𝑓𝑁表示第M個與第N個住宅的總坪數；而max{𝑆𝑓}與𝑚𝑖𝑛{𝑆𝑓}分別表示所有樣本住宅中最大總坪數與最小總坪數。當所計算出的X越小，代表M與N住宅相似度越高，以此類推。除此之外，該篇文獻主要在探討哪項住宅特徵與電力解析最具影響與關聯性，並無找出X2、X5與X6之合併最佳解，因此，本研究分別計算結果，並找出提升準確度最多的參數，作為CTL遷移式學習精進的作法。
表4-9為透過問卷調查的方式詢問示範住戶的實際坪數；再參考文獻的作法計算X2，以及欲遷移之目標示範住戶的模型(Target)，如表4-10所示：
表4-9、示範住戶實際坪數



表4-10、坪數X2的計算結果

同理，計算X5 (相同種類設備數量)，而示範住戶的設備種類如表4-11所示：
表4-11、示範住戶的設備種類

表4-12為X5的計算結果，以及欲遷移之目標示範住戶的模型(Target)，經過交叉計算比對，所有示範住戶的相同種類設備數量最大為6。
表4-12、相同種類設備數量X5的計算結果

將𝑋2與𝑋5個別更新目標模型比較精進準確度之成效，然而，因為物理意義不同，不合併尋找目標模型，本研究的作法為若𝑋2或𝑋5之目標模型存在，則更新；否則，照Pearson correlation演算法找出之模型，如表4-13所示：
表4-13、X2與X5獨立分開之計算結果

表4-14為利用Pearson correlation演算法，計算出所有示範住戶Seg1、Seg2、Seg3和Seg4準確度的平均值，其平均準確度約為72%。
表4-14、前期30戶示範住戶遷移模型驗證結果
 (利用Pearson correlation 演算法，Seg1~Seg4的平均值)
然而，加入𝑿2(即住戶坪數特徵)後，並更新模型，再次計算出所有示範住戶Seg1、Seg2、Seg3和Seg4準確度的平均值，其平均準確度約為52%，如表4-15所示，可以發現，住宅坪數特徵對於遷移式學習演算法應用於用電解析之準確度在我國家庭真實用電資料之精進有限，並且在此次研究降低其準確度；另外，加入𝑿5(即相同種類設備數量特徵)後，並更新模型，再次計算出所有示範住戶Seg1、Seg2、Seg3和Seg4準確度的平均值，其平均準確度約為78%，如表4-16所示，可以觀察到，相同種類設備數量特徵對於遷移式學習演算法應用於用電解析之準確度在我國家庭真實用電資料之精進有明顯幫助，並且在此次研究提升其準確度。
表4-15、加入住戶坪數特徵𝑿2後更新模型，並計算準確度


表4-16、加入相同種類設備數量𝑿5後更新模型，並計算準確度
小結：
住宅坪數特徵對於精進準確度之效益低
住宅相同種類設備數量對於精進準確度之效益較佳
利用Pearson correlation 整合住宅相同設備數量，提升準確度達0.77

4.7、HEMS計畫之智慧電表Route B資料整合
與HEMS計畫的執行單位「聯齊科技」協作，智慧電表Route B(100戶示範住戶每1分鐘用電資料)會定期上傳至台電鳳山實驗屋的伺服器主機的VM2所架設的雲端FTP，整合架構如圖4-33所示：

圖4-33、與HEMS計畫協作之資料整合架構
將雲端FTP的Route B原始資料自動化擷取後，首先會作一前處理的程序，以利於遷移式學習演算法的運算。雲端FTP的Route B原始資料如圖4-34所示，包含100戶示範住戶的電表號、每一天為一個csv檔以及每一分鐘之總用電量的累計值。

圖4-34、雲端FTP的Route B原始資料
Route B的前處理有兩部分，分別為1. 將總用電累計值轉換成每一分鐘一筆之耗電量(kWh)；2. 將每天資料不足1440筆補齊(缺值補值)，參照台電VEE的方式。
VEE(Validation、Estimation、and Editing)資料篩選：
為了監測大數據資料傳輸數據期間的狀態，希望能夠區分所考慮系統的正常狀態和異常狀態。例如，分析來自感測器內智慧工廠之訊號，以辨識出現異常問題，需要更換。基於生理訊號，專家可以確定任何人之健康狀況。然而，在許多情況下，從正常訊號檢測異常變得具有一定之挑戰性，因為異常或正常的定義可能經常改變。一般而言，異常檢測是不符合給定數據集之期望模式的數據、模式、觀察或事件等。使用異常檢測演算法非常有助於行為分析或支持其他類型的分析，如檢測、識別和預測這些異常的發生。AMI用電數據龐大，偶會出現異常值，影響後續在用電分析之客觀性，本計畫參考如表4-17所示之台電公司所訂之資料來源判斷與編輯處理(Validation, Estimation, and Editing; VEE)方法來篩選並判定異常值，作出相對應之檢測並排除：
表4-17、台電公司VEE資料篩選方法
線性插補：
參考如圖4-35所示之「智慧型電表管理系統之遺失值處理」，其中Read_valueend為缺值後再次於電表讀到之累計值(kWh)；Read_valuestart為缺值前一筆之電表累計值，將頭尾相減並除以缺值數(Countmiss)，則可計算出每單位時間(15分鐘)之平均用電量，於缺值處插補如圖4-35右側紅色字體所示。

圖4-35、線性插補方法示意圖
此為Route A(15分一筆)之電表資料處理示意圖，參考並應用於Route B(1分一筆)的資料上，最後，經過遷移式學習演算法執行並輸出結果如圖4-36所示，第一欄為時間欄位，同樣每一分鐘一筆資料；第二欄~第九欄分別為總用電量、冷氣或其他高耗能設備、照明、電鍋、電視機、洗衣機、冰箱以及其他基本電力(或待機電力)，再將每一個csv檔案透過自動化程式設定排程定期上傳回台電FTP雲端。

圖4-36、經過遷移式學習演算法執行並輸出結果


4.8、示範住戶實場技術驗證
本計畫與HEMS計畫共同協作，在智慧電表Route B之示範住戶家中安裝插座電表做遷移式學習演算法成果驗證，其中，不同示範住戶安裝插座電表的家電設備不盡相同，如表4-18所示，挑選配合度較佳的示範住戶進行實場技術驗證，而遷移式學習演算法主要針對冷氣或其他高耗能設備、照明、電鍋、電視機、洗衣機、冰箱等驗證其準確性。
表4-18、示範住戶安裝插座電表的家電種類

從上表可以觀察出，普遍示範住戶安裝插座電表於洗衣機、冰箱、電視以及烹飪煮食設備(如電鍋、微波爐)佔最多數，同時符合遷移學習演算法解析家電的種類。而其他家電設備如空氣清淨機、咖啡機、手機充電器以及氣炸鍋等較特殊的家電設備，亦可以藉由插座電表收集電力特徵資料，作為訓練並新增電器指紋模型，擴充背景模型資料庫。圖4-37與圖4-38分別為某示範住戶A在2022年6月1號到6月15號約兩週的時間藉由實際插座電表量測設備電力的資料與透過遷移式學習演算法解析出設備的電力資料，準確度約為0.71；而表4-19為實場示範住戶解析結果之準確度，平均約為0.73。

圖4-37、示範住戶A藉由插座電表量測設備電力資料

圖4-38、示範住戶A透過遷移式學習演算法解析出設備電力資料
表4-19、示範住戶遷移學習解析設備準確度

結論：
應用遷移式學習演算法於HEMS的Route B資料確實可以將總電力資料拆解出不同家電設備之能耗，利用插座電表驗證其準確度也達7成以上，在未來商業應用上具高度的價值。
此外，遷移式學習演算法亦拆解出其他示範住戶家中沒有安裝插座電表的設備，如冷氣機以及照明設備等，此部分亦可以藉由互動式問卷調查進行驗證，並將回饋的結果納入演算法中，作為提升準確度的參考指標。



第五章、高頻穩態NIALM應用之技術精進
本分項工作導入50戶實際家庭住戶進行NIALM之精進與功能驗證，在實際導入前，已針對示範用戶Home050進行不同特徵參數對模型性能與不同視窗長度對模型性能的影響，由示範用戶Home050模型性能分析結果為採用實功(P)、虛功(Q)、總電流諧波失真率(Total Harmonic Distorsion Current, THDI)為特徵參數，其所有家電運轉組合皆正確之辨識準確率為最高。當時間視窗為9時，其所有家電運轉組合皆正確之辨識準確率為最高。因此導入50戶實際家庭住戶時將採用(P+Q+THDI)為其特徵參數，時間視窗定為9。目標標籤值為各個電器運轉狀態(0或1)之排列組合值，並依此特徵值進行SVM機器學習多標籤分類(LibSVM Multi-label)之建模並進行測試驗證。
5.1、NIALM高頻穩態前期計畫與後期計畫作法分析
本期計畫採用LibSVM Muti-label Classification多重類別分類器來進行NIALM高頻穩態分析，其高頻穩態特徵為實功(P)、虛功(Q)、總電流諧波失真率(THDI)。表5-1為前期計畫與本期高頻穩態特徵NIALM技術精進開發計畫之比較表。






表5-1、前期與本期高頻穩態特徵NIALM技術開發之比較表
資料來源：本研究整理
利用Home050示範用戶來進行前期計畫與本期計畫之成果分析如表5-2得知，本期NIALM高頻穩態精進計畫經Home050示範用戶在相同訓練資料、相同測試資料、相同時間視窗、相同測試電器之條件下，本期計畫同時間點9個家電排列組合皆正確之正確率之Accuracy為77.6%，本期計畫比前期計畫提升約10%，在各家電分別計算F-Score之平均為62.4%，本期計畫比前期計畫提升約14%，因此利用本期採用之開發工具與增加總電流諧波失真率(THDI)之特徵參數，將有效提升整體辨識率。
表5-2、前期計畫與後期計畫之成果分析比較
資料來源：本研究整理
圖5-1為整個NIALM性能驗證之流程步驟，說明如下：
依據電表配置表製作Config檔：利用工程人員入戶安裝時所製作之電表配置表，製作相對應之Config檔。
定義模型建置訓練資料及之時間區間：須定義出建置模型時，所需訓練資料之時間區間，目前訓練資料取樣為連續7日。
定義出欲測試解析性能之時間區間：須定義出欲測試NIALM性能之時間區間，目前之測試時間區間為7日。
於測試性能之時間區間內，進行各家電之用電解析：依據總用電之取樣頻率，並以建立好之每個電器之NIALM模型，進行每個受測電器之用電解析。
計算此測試戶之性能指標：將每個家電於此測試時間區內之所有總用電資料取樣點所解析出之各個電器運轉狀態(0或1)之排列組合值，並計算出所有家電運轉組合皆正確之辨識準，計算出測試期間所有電器皆正確辨識率之平均值。

資料來源：本研究整理
圖5-1、NIALM性能驗證流程說明



5.2、國內NIALM示範場域性能驗證
本期計畫已完成50戶示範用戶的測試系統安裝及資料收集，本分項工作將針對所收集之數據，利用SVM機器學習多標籤分類(LibSVM Multi-label)進行NIALM用電解析模型與NIALM性能驗證。
示範用戶2021年09月19日至2022年05月10日資料作為NIALM用電解析建模及驗證使用，採用之演算法為SVM機器學習之多重分類器(LibSVM Multi-label)，用電資料取樣週期為10秒鐘，用電資料特徵採用總用電的實功(P)、虛功(Q)、總電流諧波失真率(Total Harmonic Distorsion Current, THDI)。
因目前部分用戶電器用電資料收集品質不佳(遺失率過高>20%或無電器使用行為)等因素、無連續7日訓練資料集、資料少於14日、資料無上傳等因素剔除部分示範用戶，用電紀錄資料收集不全因素的相關原因說明如表5-3，有部分資料不全的住戶需要入戶檢修，但因疫情影響，住戶要求暫緩檢修安排。可用於作NIALM解析測試的用戶共有43戶，表5-4列出示範用戶可作用電解析之測試資料期間範圍。表5-5列出示範用戶在測試時間內測試之結果，整理出各個示範用戶其同時間點所有家電運轉組合皆正確之辨識準確率(MultiLabel Accuracy)、個別家電辨識正確率(Accuracy)與個別家電辨識正確率(F-Score)。


表5-3、示範用戶資料收集不全因素說明
資料來源：本研究整理

表5-4、示範用戶測試期間表
表5-5、示範用戶全部家電辨識準確率與家電組合
資料來源：本研究整理


5.3、國內NIALM示範場域性能分析
導入50戶示範用戶後，所有家電皆辨識正確率平均(MultiLabel Accuracy)為77.51%，個別家電辨識正確率平均(Accuracy)為96.44%，個別家電辨識正確率平均(F-Score)為69.11%。表5-6為前期計畫30戶示範用戶與本期計畫50戶示範用戶全部家電測試結果比較表，本期高頻穩態特徵NIALM技術精進開發比前期高頻穩態NIALM技術計畫在各家電分別計算F-Score之平均提升約9 ~14%。若針對同時間點每個家電皆辨識正確率平均有77.51%，有此結果得知本期計畫作法有效提升家電辨識率。
表5-6、前期計畫與本期計畫全部家電測試結果
資料來源：本研究整理
從50戶示範用戶觀察到干擾辨識率的因素如同戶有預測同種多個低功率電器、低功率電器、電器使用頻率過低、受到低溫影響、年假假期、訓練資料和測試資料有資料不全、家庭電器組合等，以上因素皆會影響家電運轉預測之辨識率。因此當家電辨識率降低時，可以從示範用戶收集之資料去觀察影響辨識率的原因。從示範用戶試驗分析中得知在不同季節建置之模型，在另一個季節預測會有模型失準之現象。因此必須在不同季節重新建置模型，以維持模型之高辨識率。




第六章、高頻穩態NIALM之示範住戶實場應用
本分項工作招募50戶家庭用戶進行高頻穩態實場域試驗，以驗證NIALM精進性能及家居照護及保全應用服務之可行性。
6.1、高頻穩態示範住戶招募程序
前期計畫招募30戶示範住戶，其參與時程為2019年~2021年，並於2021/10/31計畫終止，不願意繼續參加的示範住戶由本計畫協助進行環境重整、清潔與裝置回收。詢問願意繼續參加本期計畫之示範住戶有10戶，安排進行合作同意書簽約(示範住戶同意書已由台電公司法務單位經閱讀後可行)、聯絡住戶入戶安裝之系統更新等事宜，以完成共50戶示範住戶實場域建置之計畫目標。
本計畫與新光保全公司合作導入實場域之應用服務驗證，由新光保全公司提供30示範住戶清單，經由本計畫聯繫與場勘，有23戶合適與願意參加，不願意參加的原因有：同住家人未知、反對、隱私考量、場勘後發現住戶現場環境不適合安裝。
本計畫由元智大學老人科技福祉中心協助聯繫關渡醫院，陳院長樂於協助引薦示範住戶，提供7戶示範住戶清單，經由本計畫聯繫與場勘，有3戶合適與願意參加。圖6-1為示範住戶招募管道及時程與入戶安裝流程。

圖6-1、本期示範住戶招募管道及時程與入戶安裝流程
示範住戶入戶安裝配合事項說明如下：
住戶須先提供家中開關箱外觀、內部迴路標籤，以利技師規劃入戶安裝流程，縮短入戶停留時間；
8項目標家電：冷氣、電磁爐、電視機、洗衣機、吸塵器、電鍋、微波爐、電熱家電(參考日本東京電力公司)；
用戶選擇常用的5項家電，每日會使用(3分鐘以上)、每周至少使用兩次以上，安裝插座電表，使用台規3孔插座，120V, 15A, 1500W以下；插座電表的體積尺寸為8cm x 4cm x 5cm，會稍微佔據家電插頭與牆壁插座空間。
單層平面 50坪以內，降低4G及無線通訊傳輸干擾；
技師安裝總電表外掛箱時，住戶填寫期初問卷。總開關箱下方約有40cm x 40cm x 17cm的空間，安裝外掛式收納盒；
1組總電表系統、5個插座電表及4G無線網路閘道器系統，規格如下表6-2，正常運轉與待機電力合計約小於 0.25度/日，1年約92度；
4G無線網路及閘道器系統，放置於外掛式收納盒內，用以收集與上傳總電表與插座電表之用電資訊，只專屬於本工作安裝的總電表與插座電表之數據傳輸使用，請勿移作他用；
簽署示範住戶參加同意書(已由台電法務單位經閱讀應為可行)。
本計畫示範住戶招募來源包括，由新光保全及關渡醫院引薦、與前期示範住戶徵詢，共招募到50戶示範住戶參加本期計畫，並於111年4月24日完成共50戶入戶安裝。如下圖6-2為示範住戶入戶安裝高頻穩態電表系統裝置圖。

圖6-2、示範住戶入戶安裝高頻穩態電表系統裝置圖
本計畫共招募50戶示範住戶，所在地點與房屋類型如下表6-1。
表6-1、本計畫招募共50戶示範住戶地點與房屋類型


表6-2、實場域試驗所需關鍵設備規格說明

本計畫在示範住戶家中安裝4G無線路由器，民眾對於IoT無線電波疑慮的回應如下：根據國家通訊傳播委員會訂定「2.4GHz電信終端設備技術規範」法規[6-10]之5.測試項目及合格標準，5.1 無線介面之測試項目及合格標準，5.1.1頻率範圍：2400至2483.5MHz，5.1.2峰值輸出功率：採用數位調變及使用75個以上(含)跳頻頻道之跳頻系統(hopping channel)應不得超過1瓦(W)，其餘不得超過125毫瓦(mW)。傳輸功率< 20 dBm(100mW)。



6.2、高頻穩態用電資料收集系統與展示架構
本計畫於示範住戶內安裝多迴路電力量表PA60(量測配電盤內總用電、冷氣及照明迴路用電等)，提供之電力參數包括穩態之P, Q，亦可提供THD(Total Harmonic Distortion)總諧波失真等參數。而示範住戶家中的主要家電設備(110V)的使用狀態標籤，則由插座電表來收集與記錄。
本計畫實場域用電資料之資料傳輸通訊協定，採用目前物聯網IoT領域最主流之MQTT(Message Queuing Telemetry Transport)通訊協定，是由IBM的Andy Stanford-Clark博士等研究人員於1999年發明的即時通訊協定[6-2]，為了有限的網路頻寬和微小電力損耗的需求應用。2013年，IBM發行Node-RED開源視覺化界面開發工具[6-3]，提供MQTT之發佈、訂閱、顯示與互動功能，促進IoT物聯網應用發展。

圖6-3、高頻穩態NIALM資料透過MQTT資料流
如上圖6-3，透過資料收集IoT系統，將所收集到的用電資訊以MQTT方式傳回雲端平台，資料收集IoT系統包括一個資料收集閘道器GW與4G路由器(含Wifi分享器功能)，資料收集閘道器Pi以每10秒一筆之訂閱(mqtt.subscribe)週期，收集來自示範住戶家中的PA60多迴路電表以及所有插座電表發佈(mqtt.publish)之用電資料，資料收集閘道器Pi並具有MQTT轉發功能，示範住戶(home001~home050)的用電資料會持續發佈(mqtt.publish)至雲端平台，並於隔日凌晨以FTP檔案傳輸協定(File Transfer Protocol)，透過網際網路傳送至鳳山實驗屋伺服器FTP資料庫。
本計畫於鳳山實驗屋自行建置MQTT Broker，可將所有示範住戶(home001~home050)系統所發布的用電資料，轉發給訂閱者(Telegraf)，再儲存進InfluxDB時序資料庫[6-4]。InfluxDB提供開源Telegraf代理程式，可訂閱MQTT後轉存入資料庫。
InfluxDB是一個由InfluxData開發的開源時序資料庫，由Go語言寫成，著力於高性能地查詢與存儲時序型數據。InfluxDB被廣泛應用於存儲系統的監控數據，IoT行業的實時數據等應用場景[6-5]。InfluxDB支援時間序列資料快速存取與多程式開發語系，學術期刊也有使用InfluxDB作為資料庫開發工具[6-6]，如下圖6-4(資料來源：[6-7])。本計畫應用InfluxDB來儲存透過MQTT發布與訂閱的時間序列用電資料。

圖6-4、InfluxDB支援時序資料儲存與多語言程式開發
本計畫採用Grafana[6-8]開放儀表板顯示用電資訊，提供示範住戶了解自宅用電。Grafana具備豐富多樣的面板設計，包括基本文字、表格、圖表，也提供如甘特圖、流程圖等面板來顯示所IoT監控的資料，並提供可自行調整顯示資料的顏色設定。
Grafana支援InfluxDB時間序列資料庫、網頁語法、可嵌入Google分析、可設定規則式(Rule-based)的警報通知(Alert)，支援MQTT IoT可視化，Linux開源生態系支援完整，微軟、國內研華公司都有採用相關服務。
如下圖6-5為本計畫提供示範住戶用電分析儀表板，採用網頁、手機等響應式網頁設計(Responsive Web Design, RWD)，透過示範住戶的Email寄發網址、帳號與密碼，提供示範住戶登入，了解自宅用電變化。


圖6-5、使用Grafana儀表板顯示用電資訊
在用電儀表板上嵌入氣候[6-11]、空氣品質[6-12]等Open data開放資料，讓示範住戶可以了解自宅附近的天氣變化、空氣品質指數等。
本計畫提供示範住戶用電分析儀表板，是讓住戶有參與感，本計畫入戶安裝高頻穩態電表，都有專業技師說明相關細節。本計畫提供用電分析儀表板呈現住戶家中用電量變化，可讓住戶產生自主節電意識，另一方面，是希望住戶可善盡設備保管責任，當看到儀表板上有資料斷線時，可協助先行處理或通報本計畫窗口，以維持資訊傳輸穩定性。


6.3、外部資料傳遞至台電綜研所內網之運作流程
因應台電公司資安規定，外部資料傳遞至內網台電綜研所之運作流程如圖6-6，規定如下：
向台電資訊處申請：主機固定IP申請為白名單，獲得wftp的網址、帳號、密碼
台電內網：綜研所內部電腦、用戶服務大數據平台的IP向資訊處申請為白名單
外網白名單主機：依據指定格式，每日定時上傳至wftp
內網資料轉存：台電內網連接wftp，轉存至用戶服務大數據平台

圖6-6、外部資料傳遞至台電綜研所內網之運作流程


圖6-7、用戶服務大數據平台的資料輸入格式範例
上圖6-7為配合用戶服務大數據平台之指定資料格式，得以順利在台電wftp經由內網傳存入用戶服務大數據平台。



6.4、高頻穩態NIALM應用之異業結盟商業模式
日本東電公司與關西電力公司除了穩定供售電主業外，另外提供加值服務以強化客戶關係管理(Customer Relationship Management)。本計畫研析日本東京電力公司與關西電力公司的遠端觀護商業服務，如下圖6-8，日本東京電力公司透過額外裝設於室內開關箱配電盤的NIALM傳感器，以高頻特徵(每1秒)與NIALM技術解析出屋內家電的定性使用狀態，分析長者的活動狀態，若有異常狀況，則通知子女，或是派遣人員入戶訪視。關西電力公司提供其智慧電表契約客戶獲得免費加值服務，與富士通公司合作分析智慧電表的用電資料(每30分鐘)，建立過去30天的日常用電行為常模，如有異於正常作息，則Email通知子女。這兩項服務可歸納為B2C商業模式，由電力公司B直接服務其客戶C。
從另一個角度思考，富士通公司具有智慧數據分析能力與技術，以富士通而言，提供專業分析服務給關西電力公司，並不會直接面對客戶，可專注在自身優勢上，持續優化智慧電表用電資訊分析技術。

圖6-8、日本東京電力與關西電力公司之B2C商業模式整理
如下圖6-9，本計畫由國際最新NIALM商業應用技術發展調研，建議台電公司可朝向B2B2C異業結盟商業模式，台電公司的通路觸及全台家庭用戶，擁有完整收費機制，以及獨一無二智慧電表資訊，台電公司能作為用電資訊提供者，提供智慧電表資訊給現有家居照護與保全業、智慧家庭與智慧家電系統、HEMS整合廠商，整合廠商現有服務。
本計畫研究高頻穩態NIALM應用之B2B2C異業結盟商業模式之可行性，因為示範住戶來源主要由新光保全、關渡醫院引薦，已有事先說明本計畫屬性，住戶配合度較高，再由本計畫入戶安裝高頻穩態電表系統，以進行兩項示範服務試驗，說明如下：
B2C模式：提供給示範住戶可了解「自宅用電分析」的網頁儀表板，可讓住戶有參與感，協助維護家中裝置順利運作
B2B2C模式：提供給家居照護與保全業的「用電作息異常通知」之6種照護情境試驗，在保全服務本業上，未來可提供遠端觀護之加值服務。

圖6-9、本計畫高頻穩態NIALM應用之商業模式
本計畫以「用電作息異常通知」為研究方向，以50戶示範住戶實場域進行驗證，分析總用電與NIALM解析主要家電種類，如下表6-3，家電種類參考來源包括：台電106年度家用電器普及狀況調查、能源局節電宣導新聞摘要、台電計畫之村里用電熱區問卷調查、台電鳳山實驗屋之高頻暫態場景三實驗、50戶與100戶示範住戶之家電種類調查，整理10種主要家電種類。
表6-3、本計畫分析總用電與解析主要家電種類

上述10種家電，已可支持住戶在宅基本生活機能所需，包括烹飪煮食、家務工作、個人衛生、休閒社交，與臥床睡眠。
下表6-4為本計畫整理，由總用電與10種主要家電，並可搭配智慧IoT裝置，可衍生出更多具利基的商業服務應用情境。
表6-4、本計畫提出NIALM之商業服務應用情境



6.5、「用電作息異常通知」照護情境模擬試驗
本計畫以「用電作息異常通知」為研究方向，整理6種照護情境如下：
半夜使用(使用時段用電量過高不合理)
較少使用(16小時內沒有使用，極低的電費)
用戶用電量之間的巨大差異
某種用電趨勢發生突起變化(參考台電公司VEE規則)
怕中暑(戶外溫度超過36度，空調未使用則建議使用)
長期使用(電器使用時間過長，超過3小時)
上述第5項與第6項情境，是以電器使用狀態為目標，可透過第三章與第五章的NAILM技術解析家電運轉狀態。第1~4項情境則是以總用電為目標，以下說明實作程序。
(一) 入戶安裝高頻穩態電表，住宅總用電收集7天
本計畫於示範住戶家中開關箱安裝高頻穩態電表，收集總用電、實功、虛功、總諧波失真率等特徵。收集總用電資料7天以上，如下圖6-10，每分鐘1筆，1天共1440筆，前7天的某個時段t的7筆用電資料，找出最大值、平均值與最小值，可繪製3條用電曲線，可做為該示範住戶前7天的用電行為觀察，例如白天時間可觀察住戶使用較高功率之家電，深夜時段可獲得背景用電資訊，如冰箱用電，屬於非活躍狀態。

圖6-10、住宅總用電收集7天建立用電行為觀察
(二) 應用包絡線(Envelope)原理保留用電特徵與範圍
本計畫應用包絡線(Envelope)原理[6-13]，如圖6-11，是幾何學概念，代表一條曲線與某個曲線中的每條線都有至少一點相切。透過包絡線，尋找上述三條曲線的切點，連成切線，形成觀察範圍，可保留前7天用電特徵與上下範圍。

圖6-11、包絡線(Envelope)原理
如下圖6-12，某示範住戶收集前7天總用電資料(左圖)，建立3條用電曲線，透過包絡線，形成上下界線觀察範圍(右圖)。

圖6-12、應用包絡線(Envelope)原理形成觀察範圍
如下圖6-13，為不同示範住戶所建立的用電行為包絡線，可以觀察不同住戶用電行為生活作息的差異。

圖6-13、不同示範住戶的用電行為包絡線
(三) 「家居照護關懷五線譜」與「家居照護關懷九宮格」試驗模擬
如圖6-14，本計畫提出「家居照護關懷五線譜」，由上下限界線的包絡線的最大值、最大值x閥值、前7天的平均值、包絡線下界線最小值 x 閥值、包絡線下界線最小值，可以得到5條水平線與3種觀護狀況，包括警界、注意與關懷。

圖6-14、由用電行為包絡線產生家居照護五線譜
由前7天總用電建立包絡線，產生五線譜之3種觀護狀況，以第8天為例，當示範住戶的總用電落在中間區間，表示用電行為正常，可提供適當關懷。當總用電開始超過包絡線上界線最大值x閥值時，則進入注意。當總用電開始超過包絡線上界線最大值，則進入警戒，可電話連絡或派員訪視。
如下圖6-15為某住戶建立由前7天(2/13~2/19)產生的用電行為包絡線範圍，觀察2/22與2/23，可發現2/22下午時段，住戶用電有超過包絡線(左圖)，2/23凌晨時段，住戶用電有超過包絡線(右圖)。

圖6-15、觀察住戶用電行為是否與前7天包絡線有差異狀況
如下圖6-16，本計畫針對不同的觀察窗口(observation window)，提出「家居照護關懷九宮格」，可依據客戶需求，將全時段拆分成早、中、晚的3個時段進行9種情境觀護，例如以0時到8時，如有用電量高於包絡線上界線最大值，則直接進入警戒狀態，以提供更精細的服務。

圖6-16、不同觀察窗口之家居照護五線譜與九宮格應用情境
本計畫提出「家居照護關懷五線譜」與「家居照護關懷九宮格」，可應用在「用電作息異常通知」之下列2項照護情境：
半夜使用(使用時段用電量過高不合理)：0~8時用電量高於包絡線上界線最大值
較少使用(16小時內沒有使用，極低的電費)：低於示範住戶下界線最小值長達16小時
當家居保全業者的服務中心人員觀察某住戶出現照護情境之異常狀況時，可連絡住戶或派員訪視，詢問住戶是否有異常狀況發生。
(三) 「用戶用電量之間的巨大差異」實作說明
示範住戶用電量與家庭人員組成、家電設備數量、使用行為、區域氣候有關，如圖6-17，本計畫將招募到的50戶示範住戶，透過高頻穩態電表系統所收集到的用電量數據，採用同步顯現方式，試驗模擬呈現提供家居與保全業者可同時觀察不同區域示範住戶的觀護儀表板，統計前8個小時的用電量互相比較，當保全業者發現同一區域的某示範住戶用電量與其他住戶的用電量有巨大差異時，可以進行聯絡或入戶訪視，詢問住戶是否有異常狀況發生，例如可能是電熱水器持續加溫、電烤箱故障、開飲機故障而持續加熱等。


圖6-17、用戶用電量之間的巨大差異的觀護儀表板

(四) 「某種用電趨勢發生突起變化」說明
本計畫以「用電作息異常通知」為研究方向，當某種用電趨勢發生突起變化時，示範住戶家中用電情形可能有異常狀況，學術研究上，開發各種異常偵測(Anomaly Detection)方法，來識別這些異常，包括智慧電表時序資料異常、信用卡盜刷詐欺、心電脈搏資料異常等。
主要定義如下：
對罕見項目、事件或觀察結果的識別、偵測
這些事件或觀察結果與大多數數據有顯著差異，從而引起懷疑
異常也稱為離群值、新穎性、噪音、偏差和例外
用戶的行為、人為失誤、和性能不佳的家電設備等，可能造成能源消耗的浪費，識別異常的用電行為是減少峰值能耗和改變不良用戶行為的解決方案之一。
下表6-5為台電公司VEE(Validation、Estimation、and Editing)資料篩選規則[6-14]，是為了監測大數據資料傳輸數據期間的狀態，希望能夠區分所考慮系統的正常狀態和異常狀態，使用異常檢測演算法有助於行為分析或支持其他類型的分析，如檢測、識別和預測這些異常的發生。AMI用電數據龐大，偶會出現異常值或缺值，影響後續在用電分析之客觀性，參考台電公司所訂之資料來源判斷與編輯處理(VEE)方法來篩選並判定異常值，作出相對應之檢測並排除。
表6-5、台電公司VEE資料篩選規則

本計畫參考台電公司VEE規則的用電量突升，篩選門檻條件是依單位時間內最大峰值大於第三大峰值1.8倍以上為門檻值，如下圖6-18，用電量突升示意圖。

圖6-18、用電量突升示意圖
如下表6-6，觀察不同示範住戶，以1天為單位時間，用電量突升max1/max2的倍數分析表，可觀察到部分示範住戶在某一天確實有發生用電量突升狀況，統計約有5.2%，尚屬合理發生機率，1.8倍數值可做本計畫之應用。
表6-6、參考台電公司VEE規則的用電量突升之發生數量統計



第七章、NIALM與使用者行為關聯研究
本分項工作分析智慧電表資訊、NIALM與使用者行為IADL(Instrumental Activities of Daily Living)，建立人(年長者)、事(IADL)、時(時間)、地(住宅內位置)、物(家電)的情境應用與關聯，以高頻NIALM應用服務試驗場域及鳳山實驗屋為測試場域，連結數據進行綜合分析。
7.1、以人為中心之非監督式學習分解方法研析
在國際學術界最新相關文獻「Unsupervised algorithm for disaggregating low-sampling-rate electricity consumption of households, 2019」[7-1]，方法為以人的中心之非監督式學習分解方法，並且應用在中歐家庭住宅的公開資料集上，藉由大量詳細問卷調查與非常低取樣頻率的實功特徵(每15分鐘一筆)，解析出住宅內電器設備的使用情形，以及使用電器設備的對象(大人或是青少年)。優點是低計算成本，並與其他監督式演算法相比較，具有相似之精準度。
該演算法在住宅資料的收集建立，十分重要，包含家庭總人數、就業狀態、男女年齡人口組成以及各成員用電行為習慣等，圖7-1為該文獻收集公開資料集ECO、SmartEnergy以及UK Domestic Appliance-Level Electricity (UK-DALE)提供之家庭結構資訊，圖7-2為其家電使用情形資訊，圖7-3為每個家庭擁有電器數量的統計。

圖7-1、公開資料集提供之家庭結構資訊


圖7-2、公開資料集提供之家電使用行為資訊



圖7-3、公開資料集提供之各家庭擁有電器數量統計
該篇研究是以一般的電器使用時間調查、住戶負載曲線、及住戶特徵等資訊做為模型輸入特徵，並利用HMM來建立戶內人員之活動鏈模型，架構如圖7-4所示。該研究有提供，解析家中是否有大人或小孩、待機電力及各種不同電器如冰箱、燈具、廚房、家事、加熱、娛樂設備、資通訊 (Information Communication Technology, ICT)等設備是否有在使用之演算流程。

圖7-4、以家庭結構及家電使用行為資訊做NIALM解析之概念圖
本研究參考上述國際文獻，於鳳山實驗屋進行真人入住實驗模擬與示範住戶實作分析，說明如下。
7.2、鳳山實驗屋家電設備與環境說明
前期NIALM計畫應用Seq2Point演算法，以每分鐘及每15分鐘所取得自電力量表的P(實功率)及Q(虛功率)等低頻穩態電力參數特徵建立個別電器之NIALM解析迴歸模型，並以台電高雄市鳳山區NIALM實驗屋(前期計畫之室內平面圖與家電位置如圖7-5所示)及以實際30戶家庭住戶作性能驗證場域。

圖7-5、前期計畫之鳳山實驗屋開關箱與室內設備佈置圖
鳳山實驗屋為兩房、兩廳、兩衛、及陽台之公寓房型，兩衛設施中其中一個包括廁所及淋浴設施，另一個僅有廁所。
鳳山實驗屋內裝設有傳統式日光燈照明與新裝LED智慧照明(含室內及前後陽台共計11座燈具開關)、3台空調、電冰箱、除溼機、電磁爐、電鍋、咖啡機、洗衣機、乾衣機、電視、電風扇、電熱水器等，共計27項家電設備(包括照明開關)，做為本期計畫NIALM高頻暫態特徵萃取實驗之目標家電。主要家電之運轉功率如表7-1所示。
表7-1、鳳山實驗屋內主要家電無運轉時的用電數據

鳳山實驗屋之屋齡久遠、歷年多項計畫使用、電氣安全因素考量、110年有3項計畫共用等需求，已與另兩個計畫主持人(ADR, HEMS)溝通，由綜研所協調實驗時間、共享行事曆，以避免互相干擾。由本計畫負責移除不屬於這三個計畫的裝置，以降低實驗屋電氣干擾因素，與另兩個計畫團隊說明實驗後裝置電源復歸程序，與新增收納櫃以利環境整理。本計畫負責提供鳳山實驗屋基本機能，包括飲用水、茶包與咖啡包等補給，提供實驗人員日常工作所需。
如下圖7-6，在台電綜研所同意下，本計畫與專業技師討論，進行室內配線重整與開關箱更新如圖7-7，包括3台冷氣使用獨立迴路、乾衣機獨立迴路、電熱水器獨立迴路、廚房獨立迴路，並重新安裝室內插座與照明開關，符合室內電氣安全，並在每個家電開關、插座、迴路等加上標籤說明以利進行高頻暫態特徵萃取實驗。

圖7-6、本期計畫之鳳山實驗屋室內配線重整圖

圖7-7、本期計畫之鳳山實驗屋開關箱更新
如下圖7-8為鳳山實驗屋室內等軸測投影圖(Isometric projection)，可協助本計畫與相關人員了解室內佈置、家電位置等資訊，並可做為本計畫進行高頻暫態特徵萃取實驗、高頻電力特徵之即時負載啟動/停止運轉及負載需量平台的即時顯示、低頻NIALM遷移學習技術實場域驗證、NIALM與工具性日常生活活動(IADL)之對應測試場域。

圖7-8、本期計畫之鳳山實驗屋室內等軸測投影圖
下圖7-9為本計畫高頻暫態特徵萃取實驗的目標家電位置與室內迴路關係位置圖。

圖7-9、高頻暫態實驗的目標家電位置與室內迴路關係位置圖
7.3、鳳山實驗屋實作IADL分析人事時地物
本分項參考國際文獻之作法，應用於居家有長者的情境，識別長者活躍與非活躍生活模式的方法如下：
首先濾除待機電流及冰箱耗電等背景用電
讀取用戶智慧電表每1分鐘的用電資料，每日共1440筆用電負載資料
假設用戶在凌晨2:00~4:00為「非活躍」狀態，取該區間最高用電度數，設定為「活躍」用電負載閥值
逐一比對一天內1440筆每1分鐘用電負載資料，如高於閥值判定用戶該時段為「活躍」狀態；如低於閥值判定用戶該時段為「非活躍」狀態
針對「活躍」狀態，進一步分析IADL行為模式

以定義與設定各種閥值參數作為推論IADL用電行為的方法，本分項鎖定住宅至多以兩人為用電行為分析目標；且分析對象以年長者為主要對象。
首先，以鳳山實驗屋之用電行為創造IADL模型，即人之用電Load profile，接著，再以住在鳳山實驗屋並模擬填寫問卷之作法，填寫使用設備之時段；最後，利用總用電分析：物(家電)、時(時間)、地(物在住宅內位置)、事(IADL)、人(年長者)，如圖7-10所示：

圖7-10、鳳山實驗屋實作IADL分析人事時地物
住宅總用電量透過NIALM技術解析成各個電器設備耗電後，將其分類成IADL的活動狀態，最後目標為識別出哪一位年長者在家裡使用電氣設備的活動行為。本分項研究首先利用人員居住於鳳山實驗屋一週並記錄其使用電器設備的情形，將其用電行為與總用電量記錄下來作為一行為模式負載模型的參考背景，圖7-11~圖7-17為人員一週七天在鳳山實驗屋模擬一獨居長者在家生活之情況，第一個分布圖表為電器種類數量，可記錄在不同時間中使用電器設備的數量；第二個分布圖表為一整日的總用電負載狀態；第三個圖表為將各個電器設備分類成IADL的活動狀態，即可定義在不同時間之活動行為模式。


圖7-11、人員在實驗屋模擬獨居長者在家生活第一天

圖7-12、人員在實驗屋模擬獨居長者在家生活第二天

圖7-13、人員在實驗屋模擬獨居長者在家生活第三天

圖7-14、人員在實驗屋模擬獨居長者在家生活第四天

圖7-15、人員在實驗屋模擬獨居長者在家生活第五天

圖7-16、人員在實驗屋模擬獨居長者在家生活第六天

圖7-17、人員在實驗屋模擬獨居長者在家生活第七天
從上述分析結果，可以利用聯立方程式推論IADL用電量的高低，方法如下，其中，0表示無該IADL分類下的家電設備，時間單位以每小時為單位，用電量單位為kWh。

經過計算結果，可得知Cooking約等於0.57955度；Entertainment約等於1.10645度；Housekeeping約等於0.22615度；Cleaning約等於0.377650度。聯立方程式之結果不止一種，表示不同IADL狀態使用的家電設備種類數量不同(例如：Cooking只使用咖啡機或使用咖啡機+煮水器)。透過不同的結果，可作為判斷家內的使用者身分以及使用者數量(即年長者的身分與年長者的數量)，除此之外，根據文獻表示，使用者身分的不同(文獻為大人與小孩)，IADL分類下用電量高低與習慣明顯不同，例如：大人在Housekeeping用電量較高；小孩在Entertainment用電量較高。藉此參考依據，鳳山實驗屋的研究結果可作為判斷年長者A或年長者B在家的用電行為習慣，即個別之人的負載模式指標之一。


7.4、用電與行為模式關聯分析研究應用於真實示範住戶
由於人員居住鳳山實驗屋模擬長者在家生活的情境之資料分析有限，再加上只有一位人員居住，較不容易模擬出分析兩位長者在家的情況，因此，本分項研究亦透過問卷調查的方式訪查其中一戶示範住戶，該示範住戶根據子女詢問了解確實為兩位年長者長期居住在家，以下分析以年長者A與年長者B表示，在日期上藉由子女詢問得知1/12~1/19 年長者A(Female) 獨自居住在家；1/8~1/11 年長者A +年長者B 居住在家，圖7-18~圖7-20為年長者A獨自居住在家的各電器設備使用情況(耗電功率較高的設備)，其中縱軸單位為用電度數(kWh)。

圖7-18、年長者A獨自在家各設備使用情況(1/12~1/14)

圖7-19、年長者A獨自在家各設備使用情況(1/15~1/17)

圖7-20、年長者A獨自在家各設備使用情況(1/18~1/19)
根據上述之耗電資料，可以建立年長者A的用電負載常模，即以人為單位之「行為的load profile」；另外，圖7-21~圖7-22為年長者A與年長者B兩人都在家的各電器設備使用情況(耗電功率較高的設備)，其中縱軸單位為用電度數(kWh)，可以建立兩人在家的用電負載常模。透過不同日期找出差異化，識別年長者的身分，例如在1/8~1/10有些特定時段有使用家電，且在年長者A的用電負載常模中沒有出現過，即稱為差異化，推論為年長者B使用家電或年長者A+B共同使用。


圖7-21、年長者A+B在家各設備使用情況(1/8~1/9)

圖7-22、年長者A+B在家各設備使用情況(1/10~1/11)
針對耗電功率較低的設備，如鐵捲門以及照明等，亦可以利用用電負載常模，找出差異化，如圖7-23~圖7-26為年長者A獨自居住在家的低耗電功率電器設備使用情況(鐵捲門以及照明設備)，其中縱軸單位為用電度數(kWh)。

圖7-23、年長者A在家低耗電設備使用情況(1/12~1/13)

圖7-24、年長者A在家低耗電設備使用情況(1/14~1/15)

圖7-25、年長者A在家低耗電設備使用情況(1/16~1/17)

圖7-26、年長者A在家低耗電設備使用情況(1/18~1/19)
同理，圖7-27以及圖7-28為年長者A與年長者B兩人在家的低耗電設備使用情況，其中縱軸單位為用電度數(kWh)，可以建立兩人在家的用電負載常模。透過不同日期找出差異化，識別年長者的身分，例如在1/8~1/10有特定時段使用鐵捲門，且在年長者A的用電負載常模中沒有出現過；或是照明設備耗電量的高低明顯不同，即稱為差異化，推論為年長者B使用設備或年長者A+B共同使用。

圖7-27、年長者A+B在家低耗電設備使用情況(1/8~1/9)

圖7-28、年長者A+B在家低耗電設備使用情況(1/10~1/11)
從上述可以觀察到，Cooker(電鍋)為年長者A每日固定主要使用家電之一(早上、中午或下午、晚上)；RollDoor(鐵捲門)固定每日早上開(約06:30)；晚上關(約20:30)，其他時間若有開或關，判斷為特殊用電行為。除此之外，年長者A具固定使用電腦之習慣時間，約為09:00~13:30；下午及傍晚具固定看電視習慣。最後，藉由照明設備之使用時間及耗電差異化，判斷年長者B也有開啟照明設備。
本分項研究與國際參考文獻比較如表7-2所示，國際上資料來源皆為公開資料集，而本研究則是國內智慧電表真實數據資料；目的最大的差異在於本研究主要分析人的用電行為模式，且對象是兩位年長者居住在家；在方法上採用簡易問卷調查、遷移式學習演算法並建立用電負載常模。
表7-2、國際文獻與本研究分析人的用電行為模式之比較

由於考量到未來實際商業運轉，其驗證方式若以大量問卷調查或是額外安裝插座電表及迴路電表則成本龐大，商業模式較不易運作。因此，本研究以「分群演算法」作為驗證的方法。
資料一樣採用上述同一戶示範住戶的用電資料，日期時間為1/8~1/19；資料內容為每分鐘的總用電量(kWh)，以每單位時間(1分鐘)的總用電量作為分群特徵進行分群，其結果收斂至兩群，即K=2。以下稱第一群為C0；第二群為C1，結果如圖7-29與圖7-30所示：
 
圖7-29、C0群的群中心總用電負載曲線
 
圖7-30、C1群的群中心總用電負載曲線
　　其中，C0群的資料日期正好為1/12~1/19；C1群的資料日期正好為1/8~1/11，由此可見，從分群演算法可驗證出C0群為年長者A獨自在家之用電行為；C1群為年長者A+年長者B在家之用電行為，除此之外，C0群日總用電量約為6.78度，人數為1人；C1群日總用電量約為9.35度，人數為2人，參考表7-3所示：
表7-3、兩位長者在家用電量之分兩群結果


　　若示範住戶能提供家電設備擺放的空間位置資訊，以及住宅的平面圖，則可以藉由用電行為負載常模呈現人的活動軌跡，如圖7-31所示(以示範住戶在1/12為例)。整合上述各設備使用情況的負載曲線，以一整日的時間作為單位，照順序編號1~9表示各個時間點在家中某地方作某件事，參考圖7-32(以示範住戶在1/12為例)，早上六點起床去陽台開鐵捲門(編號1)；接著約7點半到廚房使用電鍋(編號2)，以此類推。達成利用總用電分析人(年長者)、事(IADL行為活動狀態)、時(時間)、地(住宅內位置)以及物(家電)。

圖7-31、家電擺放之空間位置資訊以及住宅平面圖

 
圖7-32、照順序編號1~9表示各時間點在家中行為





第八章、結論與建議
8.1 結論
本計畫研析美、歐、日等國家的NIALM成功商業應用案例與期刊論文，美國新創公司Sense Labs擁有超高頻訊號取樣傳感器(每秒百萬筆取樣)，可取得家電電流波形中非常精細的特徵，提高辨識精確度；美國政府針對電業有要求節電義務，Bidgely公司是NIALM技術發展的領先者，以B2B2C方式協助電力公司轉型為能源使用的諮詢者，藉以改善顧客滿意度，提升顧客參與度與能源使用體驗。歐洲開始研究智慧電表數據在健康和護理支持方面的可能性，讓醫療單位可以非侵入式方式即早偵測老年人生活作息的認知異常。
日本關西電力與東京電力公司則是以B2C方式服務其用電戶，關西電力公司與富士通公司合作，使用智慧電表累積30天每30分鐘的用電數據，以推估生活常態，並在用戶發生用電變化(5種異常狀況)時發送Email通知。另一角度思考，富士通公司以其自身智慧電表數據分析技術，服務關西電力公司與電力公司的用電戶。
東京電力公司是第一個使用NIALM技術應用於老年人觀護的遠處亦安心(遠くても安心)商業服務，使用特殊傳感器每1秒傳輸特定電力參數，解析8項家電，經由10天學習，可提供4種照護情境之Email通知，東京電力公司的遠端觀護服務從東京擴展至北海道，並到歐洲展開試驗計畫，且與醫學中心合作長者的日常生活是否有認知障礙，可得知日本東京電力公司對於NIALM應用於家居照護的重視程度與發展現況。
有鑑於電力特徵於穩態(Steady State)的情況下，當負載並聯使用時具有加成(Addition)的特性。因此，若要在穩態系統中辨識出各個負載，事實上有其困難。故提出使用小波轉換(Wavelet Transform, WT)的分析如離散小波轉換(Discrete Wavelet Transform, DWT)作為負載辨識的特徵萃取技術，因小波轉換具有處理非穩態與暫態信號、同時分析時頻域信號及解析信號的局部特徵等特點。
本計畫使用虛擬儀測工程平台軟體(LabView Program)建立非侵入式高頻暫態量測負載啟動與關閉，搭配資料擷取卡(DAQ)，實現實際的非侵入式高頻暫態負載啟動與關閉的監測與負載辨識平台，實際量測鳳山實驗屋不平衡單相三線式220V/110V 配電網路住宅用戶用電設備的電氣信號，同時研究改善不平衡單相三線式配電網路電力特徵的解偶合能力，增加負載在非侵入式架構中負載使用效能與分析的能力，建構一個具有完整的非侵入式電能及需量監測與負載分析功能，進而尋求技術的改善，克服非侵入式負載辨識所面臨的各種問題。於高雄鳳山實驗屋辨識10種家庭一般常使用的電器如冰箱、客廳空調、除濕機、洗衣機、電飯鍋、電熱水器、液晶顯示器與視訊盒、電磁爐、吹風機、乾衣機等，其整體負載辨識率可以達到90.6667%，對於其中6種家庭電器其負載辨識率甚至可以達到95.5556%，對比於使用高頻穩態特徵如實功率、需功率及電流總諧波失真率的平均80%高出許多。
本計畫導入50戶實際家庭住戶進行NIALM之技術精進與功能驗證，首先利用Home050示範用戶來進行前期計畫與本期計畫之成果分析得知，本期NIALM高頻穩態精進計畫經Home050示範用戶在相同訓練資料、相同測試資料、相同時間視窗、相同測試電器之條件下，本期計畫同時間點的9個家電排列組合皆正確之正確率之Accuracy為77.6%，本期計畫比前期計畫提升約10%，在各家電分別計算F-Score之平均為62.4%，本期計畫比前期計畫提升約14%，因此利用本期採用之開發工具與增加總電流諧波失真率(THDI)之特徵參數，可有效提升整體辨識率。
導入50戶示範用戶後，所有家電皆辨識正確率平均(MultiLabel Accuracy)為77.51%，個別家電辨識正確率平均(Accuracy)為96.44%，個別家電辨識正確率平均(F-Score)為69.11%。本期高頻穩態特徵NIALM技術精進開發比前期高頻穩態NIALM技術計畫在各家電分別計算F-Score之平均提升約9 ~14%。若針對同時間點每個家電皆辨識正確率平均有77.51%，有此結果得知本期計畫作法有效提升家電辨識率。
本計畫招募50戶家庭用戶進行高頻穩態實場域試驗，以驗證NIALM精進性能及家居照護及保全應用服務之可行性。示範住戶招募來源包括：由新光保全及關渡醫院引薦、與前期示範住戶徵詢與新示範住戶推廣，共招募到50戶示範住戶參加本期計畫，並於111年4月24日完成共50戶入戶安裝與資料收集分析。
本計畫研究高頻穩態NIALM應用之B2B2C異業結盟商業模式之可行性，因為示範住戶來源主要由新光保全、關渡醫院引薦，已有事先說明本計畫屬性，住戶配合度較高，再由本計畫入戶安裝高頻穩態電表系統，所以本計畫透過B2C模式與B2B2C模式，服務示範住戶與提供家居保全業未來服務之參考。本計畫提出「用電作息異常通知」照護情境模擬試驗，透過50戶示範住戶的用電資料進行實作，作為未來家居保全業可透過用電分析提供家居觀護服務之可行性參考。
目前NIALM技術受限於需要建立各自用戶之用電解析模型、家電標籤與訓練，才能精準解析其細部用電，但於實際商業應用上無法如此進行，因此仿照影像辨識之技術發展經驗，透過遷移式學習(Transfer Learning)技術，利用已建立好之NIALM用電解析模型來解析非模型訓練用戶之用電，如此才能擴大HEMS智慧家庭相關應用之商業推廣。
NIALM與使用者行為關聯研究分析，以實際示範住戶中有兩位長者為分析對象，確實可觀察出其不同的用電行為生活習慣，再透過提供家電設備擺放的空間位置資訊，以及住宅的平面圖，可以藉由用電行為負載常模呈現人的活動軌跡，達成利用總用電分析人(年長者)、事(IADL行為活動狀態)、時(時間)、地(住宅內位置)以及物(家電)。


8.2 建議
應用先進人工智慧(Artificial Intelligence, AI)機器學習理論，將智慧電表提供之即時總電力資訊解析成各主要用電家電之用電負載組合並提供相關之加值應用服務，為目前全球電業及相關電力大數據分析服務公司之技術發展主流方向。
本計畫為了驗證NIALM技術開發，需招募示範住戶進行實場域驗證，但這兩年因疫情影響，無法順利舉辦招募說明會，且示範住戶同住家人態度、家中環境因素等，會影響住戶配合度與資料傳輸穩定性，為了台電公司後續實場域相關計畫，與示範住戶維持良好互動關係將是重要議題，建議可透過在地深耕的單位組織進行合作，包括保全業、醫院、長照社區組織等，可更精準掌握住戶屬性、需求與家中環境條件等，減少招募的冗長時間佔據整個計畫的執行過程，再建立完整資料流與處理分析，得以提供更適合的服務。
台電公司的主要業務為穩定供電，在全球電業自由化之發展趨勢，電力公司之經營策略會更加多元化，除應用電力大數據分析技術以提升售電品質外，為強化客戶關係管理，可提供不同的加值應用服務，台電公司的通路觸及全台家庭用戶，擁有完整收費機制，以及獨一無二智慧電表資訊，主要可朝向B2B2C及B2C之應用服務：
B2B2C異業合作商業模式：台電公司能作為用電資訊提供者，提供智慧電表資訊給現有家居照護與保全業，整合進照護廠商現有服務平台，以產出具推動可行性的服務運作流程。
B2C商業模式：以智慧電表資訊流為主，可整合其他智慧家庭、智慧照護IoT產品，達成彈性組合之異質資訊流，產出透明且可解釋之應用指標，服務其用電戶。
建議可持續研析國際電業服務最新發展，並進行在地化、實務技術落地，包括前瞻的高頻暫態特徵功能之傳感器技術研發，將可帶動國內相關產業，在電力公司自有優勢，創造新興的智慧能源產業與生態系。

參考資料
[1-1] Nonintrusive Appliance Load Monitoring, https://www.georgehart.com/research/nalm.html
[2-1] Sense Labs, https://sense.com/
[2-2] Grid4C, https://www.grid4c.com/
[2-3] Bidgely Inc., https://www.bidgely.com/
[2-4] Smart Future of Healthcare, https://2020health.org/
[2-5] 關西電力官網：https://kepco.jp/
[2-6] 富士通公司 Fujitsu Technology and Service Vision 2018, Customer Stories, https://www.fujitsu.com/downloads/GLOBAL/vision/2018/download-center/FTSV2018_customerstories_05_EN-2.pdf
[2-7] 東京電力官網：https://www.tepco.co.jp/index-j.html。
[2-8] 高齢者見守りサービス「遠くても安心プラン」, https://www.service.tepco.co.jp/s/Anshin_Tooku/
[2-9] インフォメティス株式会社 | Informetis Co., Ltd., https://www.informetis.com/
[2-10] Energy Gateway, https://www.ip3-tech.com/eng/products_xq-82.html
[2-11] EJ1-HB power storage system, https://re-how.net/all/935047/
[2-12] 電力データと機械学習 センサ１つでおうちの様子を簡単に見える化 - Speaker Deck, https://speakerdeck.com/hassaku/dian-li-detatoji-jie-xue-xi-sensa1tudeoutifalseyang-zi-wojian-dan-nijian-eruhua
[2-13] ヤブシタエネシス株式会社｜ヤブシタグループ, https://yabushitaenesys.co.jp/
[2-14] そっとねっと｜高齢者を見守るヤブシタのAI見守りサービス, https://sotto-net.com/
[2-15] Could my mum’s toaster help me care for her? - BBC News, https://www.bbc.com/news/stories-57009375
[2-16] 家庭内の電力使用データを活用し、認知機能低下を予測するモデル作成に世界で初めて成功｜プレスリリース・お知らせ一覧｜東京電力パワーグリッド株式会社, https://www.tepco.co.jp/pg/company/press-information/press/2021/1647325_8616.html
[2-17] Review: Sense Labs Home Energy Monitor - Residential Systems, https://www.residentialsystems.com/technology/internet-of-things/review-sense-labs-home-energy-monitor
[3-1] 江榮城,電力品質,全華圖書,第二版, 2011.
[3-2] Z. L. Gaing, “Wavelet-based neural network for power disturbance recognition and classification,” IEEE Trans. on Power Delivery, pp. 1560-1568, 2004.
[3-3] C. Cortes and V. Vapnik, "Support-vector network," Machine Learning, vol. 20, no. 3, pp. 273-297, Sept. 1995.
[3-4] C. W. Hsu and C. J. Lin, "A comparison of methods for multiclass support vector machines," IEEE Trans. Neural Networks, vol. 13, no. 2, pp. 415-425, Mar.  2002.
[3-5] H. H. Chang and N. V. Linh, "Statistical Feature Extraction for Fault Locations in Non-intrusive Fault Detection of Low Voltage Distribution Systems," Energies, vol. 10, no. 5, pp. 611, Apr. 2017.
[3-6] Y. X. Lai, C. F. Lai, Y. M. Huang, and H. C. Chao, "Multi-appliance recognition system with hybrid SVM/GMM classifier in ubiquitous smart home," Information Sciences, vol. 230, pp. 39-55, May 2013.
[3-7] C. C. Chang and C. J. Lin, "LIBSVM: a library for support vector machines," ACM Trans. on Intelligent Systems and Technology, vol. 2, no. 3, pp. 27, Apr. 2011. Software available at http://www.csie.ntu.edu.tw/~cjlin/libsvm
[3-8] M. Fernandez-Delgado, E. Cernadas, S. Barro, and D. Amorim, "Do we need hundreds of classifiers to solve real world classification problems?" J. Machine Learning Research, vol. 15, no. 1, pp. 3133-3181, Jan. 2014.
[3-9] C. C. Chang and C. J. Lin, "LIBSVM: a library for support vector machines," ACM Trans. Intell. Syst. Technol., vol. 2, no. 3, pp. 27, Apr. 2011.
[4-1] Tan, Chuanqi, et al. "A survey on deep transfer learning." International conference on artificial neural networks. Springer, Cham, 2018
[4-2] D’Incecco, Michele, Stefano Squartini, and Mingjun Zhong. "Transfer learning for non-intrusive load monitoring." IEEE Transactions on Smart Grid 11.2 (2019): 1419-1429.
[4-3] Rashid, Haroon, et al. "Evaluation of non-intrusive load monitoring algorithms  for appliance-level anomaly detection." ICASSP 2019-2019 IEEE International  Conference on Acoustics, Speech and Signal Processing (ICASSP). IEEE, 2019.
[4-4] 混淆矩陣(Confusion matrix), https://zh.wikipedia.org/wiki/混淆矩阵
[4-5] Xin Shi, HaoMing, Srinivas Shakkottai, Le Xie, Jianguo Yao, Nonintrusive load monitoring in residential households with low-resolution data, Applied Energy, Volume 252, 15 October 2019
[5-1] Support Vector Machines | SpringerLink, https://link.springer.com/referenceworkentry/10.1007%2F978-0-387-30162-4_415
[5-2] 1.4. Support Vector Machines — scikit-learn 1.0.1 documentation, https://scikit-learn.org/stable/modules/svm.html
[5-3] LIBSVM -- A Library for Support Vector Machines, https://www.csie.ntu.edu.tw/~cjlin/libsvm/
[6-1] AMI智慧電表布建資訊網, https://ami-meter.taipower.com.tw/
[6-2] MQTT – Wikipedia, https://en.wikipedia.org/wiki/MQTT
[6-3] Node-RED – IBM Developer, https://developer.ibm.com/components/node-red/
[6-4] InfluxDB: Open Source Time Series Database | InfluxData, https://www.influxdata.com/
[6-5] InfluxDB - 維基百科，自由的百科全書，https://zh.wikipedia.org/wiki/InfluxDB
[6-6] DB-Engines Ranking - popularity ranking of time Series DBMS, https://db-engines.com/en/ranking/time+series+dbms
[6-7] Anastasios Vafeiadis, et al, Energy-based decision engine for household human activity recognition, 2018 IEEE International Conference on Pervasive Computing and Communications Workshops (PerCom Workshops), 2018.
[6-8] Grafana: The open observability platform | Grafana Labs, https://grafana.com/
[6-9] Z Zhou, et. al, A Novel Transfer Learning-Based Intelligent Nonintrusive Load-Monitoring With Limited Measurements, IEEE Transactions on Instrumentation and Measurement, vol.70, 2020.
[6-10] 法規命令公告-國家通訊傳播委員會, 訂定「2.4GHz電信終端設備技術規範」，並自中華民國一百零九年七月一日生效。https://www.ncc.gov.tw/chinese/news_detail.aspx?site_content_sn=538&sn_f=43417
[6-11] Windy: Wind map & weather forecast, https://www.windy.com/
[6-12] PM2.5全台即時概況, https://env.healthinfo.tw/air/
[6-13] Envelope (waves) – Wikipedia, https://en.wikipedia.org/wiki/Envelope_(waves)
[6-14] 陳伶志, 鄭如岑, 智慧型電表管理系統之遺失值處理, Missing Data Handling for Meter Data Management Systems, 2013.
[7-1] Jordan Holweger, et al., Unsupervised algorithm for disaggregating low-sampling-rate electricity consumption of households, Sustainable Energy, Grids and Networks, Volume 19, September 2019